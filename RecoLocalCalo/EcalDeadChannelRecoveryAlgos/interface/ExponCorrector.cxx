//
// Original Author:  Georgios Daskalakis , Georgios.Daskalakis@cern.ch
//         Created:  Fri Mar 30 18:15:12 CET 2007
//         
//
//
//


#include "ExponCorrector.h"
#include <cmath>



//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



double ExponCorrector::value(int DeadCrystal, int DeadCrystalEta, int estimE, int subRegion, double estimX, double estimY) {

  double result=0.0;
  theCrystal = DeadCrystal;
  theSubR = subRegion;

  switch(estimE) 
    {
    case 50:
      ExpE_50(); break;
    default:
      ExpE_50(); break;
    }

  float X0[25],Y0[25];
  int idx; idx=0;
  for(int ix=-2;ix<3;ix++){
    for(int iy=-2;iy<3;iy++){
      X0[idx]=float(ix)*20.0;
      Y0[idx]=float(iy)*20.0;
      idx++;
    }
  }

  //==================
  double d = sqrt(pow((estimX-X0[theCrystal]),2)+pow((estimY-Y0[theCrystal]),2));
  if(d<LOWLIM)d=LOWLIM; 
  if(d>HIGLIM)d=HIGLIM; 
  result = EXPAN[0]+EXPAN[1]*d+EXPAN[2]*d*d+EXPAN[3]*d*d*d;
  //==================
  
  return result;
  
}



//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




void ExponCorrector::ExpE_50(){
 
  double DC_6__SUB_0[6]={6.988035e-01, -5.241955e-02, 5.094553e-04,  2.249889e-05, 1.562500e+01, 1.962500e+01};
  double DC_6__SUB_1[6]={1.147163e+00, -1.403141e-01, 5.994774e-03, -8.805192e-05, 1.787500e+01, 2.237500e+01};
  double DC_6__SUB_5[6]={7.122391e-01, -7.160745e-02, 2.432065e-03, -2.719902e-05, 1.812500e+01, 2.237500e+01};
  if(theCrystal==6){
    if(theSubR==0){
      for(int j=0;j<4;j++)EXPAN[j]=DC_6__SUB_0[j];
      LOWLIM = DC_6__SUB_0[4];
      HIGLIM = DC_6__SUB_0[5];
    }
    if(theSubR==1){
      for(int j=0;j<4;j++)EXPAN[j]=DC_6__SUB_1[j];
      LOWLIM = DC_6__SUB_1[4];
      HIGLIM = DC_6__SUB_1[5];
    }
    if(theSubR==5){
      for(int j=0;j<4;j++)EXPAN[j]=DC_6__SUB_5[j];
      LOWLIM = DC_6__SUB_5[4];
      HIGLIM = DC_6__SUB_5[5];
    }
  }


  double DC_8__SUB_3[6]={7.661651e-01, -7.084843e-02, 1.970247e-03, -1.305198e-05, 1.787500e+01, 2.237500e+01};
  double DC_8__SUB_4[6]={7.880124e+00, -1.170639e+00, 5.895264e-02, -1.002098e-03, 1.687500e+01, 1.962500e+01};
  double DC_8__SUB_9[6]={2.847308e+00, -3.780883e-01, 1.710198e-02, -2.615451e-04, 1.812500e+01, 2.212500e+01};
  if(theCrystal==8){
    if(theSubR==3){
      for(int j=0;j<4;j++)EXPAN[j]=DC_8__SUB_3[j];
      LOWLIM = DC_8__SUB_3[4];
      HIGLIM = DC_8__SUB_3[5];
    }
    if(theSubR==4){
      for(int j=0;j<4;j++)EXPAN[j]=DC_8__SUB_4[j];
      LOWLIM = DC_8__SUB_4[4];
      HIGLIM = DC_8__SUB_4[5];
    }
    if(theSubR==9){
      for(int j=0;j<4;j++)EXPAN[j]=DC_8__SUB_9[j];
      LOWLIM = DC_8__SUB_9[4];
      HIGLIM = DC_8__SUB_9[5];
    }
  }


  double DC_16__SUB_15[6]={1.488620e+00, -1.783270e-01, 7.412517e-03, -1.055881e-04, 1.837500e+01, 2.237500e+01};
  double DC_16__SUB_20[6]={2.954570e+00, -4.018463e-01, 1.888242e-02, -3.039138e-04, 1.612500e+01, 1.937500e+01};
  double DC_16__SUB_21[6]={8.015163e-01, -7.552633e-02, 2.308837e-03, -2.145060e-05, 1.787500e+01, 2.262500e+01};
  if(theCrystal==16){
    if(theSubR==15){
      for(int j=0;j<4;j++)EXPAN[j]=DC_16__SUB_15[j];
      LOWLIM = DC_16__SUB_15[4];
      HIGLIM = DC_16__SUB_15[5];
    }
    if(theSubR==20){
      for(int j=0;j<4;j++)EXPAN[j]=DC_16__SUB_20[j];
      LOWLIM = DC_16__SUB_20[4];
      HIGLIM = DC_16__SUB_20[5];
    }
    if(theSubR==21){
      for(int j=0;j<4;j++)EXPAN[j]=DC_16__SUB_21[j];
      LOWLIM = DC_16__SUB_21[4];
      HIGLIM = DC_16__SUB_21[5];
    }
  }

  double DC_18__SUB_19[6]={1.416402e+00, -1.806420e-01, 7.972462e-03, -1.199993e-04, 1.787500e+01, 2.262500e+01};
  double DC_18__SUB_23[6]={4.194251e+00, -5.835595e-01, 2.741645e-02, -4.322421e-04, 1.812500e+01, 2.237500e+01};
  double DC_18__SUB_24[6]={2.681779e+00, -3.893816e-01, 1.947832e-02, -3.319258e-04, 1.562500e+01, 1.937500e+01};
  if(theCrystal==18){
    if(theSubR==19){
      for(int j=0;j<4;j++)EXPAN[j]=DC_18__SUB_19[j];
      LOWLIM = DC_18__SUB_19[4];
      HIGLIM = DC_18__SUB_19[5];
    }
    if(theSubR==23){
      for(int j=0;j<4;j++)EXPAN[j]=DC_18__SUB_23[j];
      LOWLIM = DC_18__SUB_23[4];
      HIGLIM = DC_18__SUB_23[5];
    }
    if(theSubR==24){
      for(int j=0;j<4;j++)EXPAN[j]=DC_18__SUB_24[j];
      LOWLIM = DC_18__SUB_24[4];
      HIGLIM = DC_18__SUB_24[5];
    }
  }


  double DC_7[150]={
-2.254192e+00,8.773615e-01,-8.104879e-02,2.204202e-03,1.237500e+01,1.662500e+01,
-8.492041e+00,2.447796e+00,-2.122152e-01,5.812223e-03,1.162500e+01,1.487500e+01,
-1.088208e+01,2.992327e+00,-2.562457e-01,7.044847e-03,1.112500e+01,1.412500e+01,
-1.301579e+00,8.800398e-01,-9.837782e-02,3.058346e-03,1.137500e+01,1.512500e+01,
3.626007e+01,-6.877452e+00,4.367576e-01,-9.268701e-03,1.262500e+01,1.662500e+01,
3.949840e+00,-6.127214e-01,3.226193e-02,-5.715623e-04,1.562500e+01,1.987500e+01,
4.219998e+00,-6.962436e-01,3.912757e-02,-7.414084e-04,1.462500e+01,1.862500e+01,
2.969170e+00,-4.834242e-01,2.709822e-02,-5.155613e-04,1.412500e+01,1.812500e+01,
1.679327e+00,-2.394863e-01,1.182912e-02,-1.988521e-04,1.437500e+01,1.862500e+01,
1.477710e+00,-2.043778e-01,9.799566e-03,-1.599286e-04,1.537500e+01,1.987500e+01,
1.273003e+00,-1.604834e-01,6.960934e-03,-1.023872e-04,1.937500e+01,2.337500e+01,
-4.721569e-01,9.059029e-02,-5.074381e-03,8.975521e-05,1.837500e+01,2.262500e+01,
4.344981e-01,-4.276521e-02,1.444304e-03,-1.615800e-05,1.812500e+01,2.212500e+01,
5.088271e-01,-5.384739e-02,1.997008e-03,-2.531495e-05,1.837500e+01,2.262500e+01,
-2.075691e-01,4.620214e-02,-2.641805e-03,4.620105e-05,1.912500e+01,2.362500e+01,
 2.741705e-02,6.743106e-03,-5.401191e-04,1.000053e-05,2.312500e+01,2.737500e+01,
-2.564791e-01,4.004509e-02,-1.841141e-03,2.690698e-05,2.237500e+01,2.637500e+01,
1.941751e-01,-1.434651e-02,3.411754e-04,-2.193993e-06,2.212500e+01,2.587500e+01,
-2.863949e-01,4.371159e-02,-1.989210e-03,2.890197e-05,2.212500e+01,2.637500e+01,
-5.984808e-01,7.831724e-02,-3.257370e-03,4.427852e-05,2.312500e+01,2.737500e+01,
3.242949e+00,-3.312085e-01,1.133701e-02,-1.296594e-04,2.687500e+01,3.037500e+01,
-8.831326e-01,9.888605e-02,-3.596903e-03,4.305765e-05,2.637500e+01,2.987500e+01,
1.510231e+00,-1.597930e-01,5.713092e-03,-6.851978e-05,2.637500e+01,2.937500e+01,
1.159944e+00,-1.231407e-01,4.435157e-03,-5.366391e-05,2.612500e+01,3.012500e+01,
3.476164e-01,-3.352644e-02,1.141654e-03,-1.331732e-05,2.687500e+01,3.062500e+01};

  if(theCrystal==7 ){
    int idx = theSubR*6;
    for(int j=0;j<4;j++)EXPAN[j]=DC_7[idx+j];
    LOWLIM = DC_7[idx+4];
    HIGLIM = DC_7[idx+5];
  }

  double DC_17[150]={
4.217161e+00,-4.389886e-01,1.529779e-02,-1.779082e-04,2.687500e+01,3.062500e+01, 
-4.415793e-02,7.069231e-03,-2.445950e-04,2.358776e-06,2.612500e+01,3.012500e+01, 
1.612653e+00,-1.739475e-01,6.346927e-03,-7.763128e-05,2.612500e+01,2.987500e+01, 
4.170846e+00,-4.432786e-01,1.578580e-02,-1.877211e-04,2.637500e+01,3.012500e+01, 
-1.079075e+00,1.130099e-01,-3.858799e-03,4.349966e-05,2.687500e+01,3.087500e+01, 
-4.063348e-01,5.717392e-02,-2.470266e-03,3.445237e-05,2.312500e+01,2.737500e+01, 
1.338731e+00,-1.582056e-01,6.380606e-03,-8.664104e-05,2.212500e+01,2.637500e+01, 
-2.421845e-02,1.270422e-02,-7.522113e-04,1.244266e-05,2.212500e+01,2.587500e+01, 
-4.021835e-01,5.935190e-02,-2.659277e-03,3.830565e-05,2.237500e+01,2.662500e+01, 
-8.196117e-01,1.097254e-01,-4.681045e-03,6.533124e-05,2.312500e+01,2.737500e+01, 
-1.526123e-01,3.885482e-02,-2.295584e-03,4.070329e-05,1.912500e+01,2.362500e+01, 
5.311694e-01,-5.426867e-02,1.918688e-03,-2.266857e-05,1.862500e+01,2.262500e+01, 
-6.813745e-01,1.217903e-01,-6.579330e-03,1.137562e-04,1.812500e+01,2.187500e+01, 
-5.009189e-01,9.204942e-02,-4.959804e-03,8.470321e-05,1.837500e+01,2.262500e+01, 
-5.073070e-01,8.915138e-02,-4.632168e-03,7.654229e-05,1.912500e+01,2.362500e+01, 
3.418404e+00,-5.297480e-01,2.794652e-02,-4.963118e-04,1.537500e+01,1.987500e+01, 
1.659555e+00,-2.468708e-01,1.292932e-02,-2.331323e-04,1.437500e+01,1.862500e+01, 
8.423056e-01,-9.808645e-02,3.962777e-03,-5.382368e-05,1.412500e+01,1.787500e+01, 
1.469667e+00,-2.059879e-01,1.016120e-02,-1.724070e-04,1.462500e+01,1.887500e+01, 
1.176922e+00,-1.515387e-01,6.875561e-03,-1.074350e-04,1.562500e+01,1.987500e+01, 
5.720176e+00,-8.530840e-01,4.098870e-02,-6.115276e-04,1.287500e+01,1.637500e+01, 
 4.841712e-01,1.913165e-01,-3.039104e-02,1.057621e-03,1.137500e+01,1.487500e+01, 
6.498010e+00,-1.207127e+00,7.688244e-02,-1.660935e-03,1.112500e+01,1.387500e+01, 
-5.872777e+00,1.578269e+00,-1.307714e-01,3.472470e-03,1.162500e+01,1.487500e+01, 
-1.895147e+00,6.493533e-01,-5.698996e-02,1.506239e-03,1.262500e+01,1.662500e+01};

  if(theCrystal==17 ){
    int idx = theSubR*6;
    for(int j=0;j<4;j++)EXPAN[j]=DC_17[idx+j];
    LOWLIM = DC_17[idx+4];
    HIGLIM = DC_17[idx+5];
  }

  double DC_11[150]={
-7.841682e+00,1.823860e+00,-1.334697e-01,3.150600e-03,1.312500e+01,1.662500e+01, 
8.018543e-01,-8.658559e-02,3.149128e-03,-3.654744e-05,1.537500e+01,1.987500e+01, 
-4.133606e-01,7.704605e-02,-4.101209e-03,6.866478e-05,1.937500e+01,2.387500e+01, 
-5.934164e-01,8.104380e-02,-3.460635e-03,4.795556e-05,2.312500e+01,2.737500e+01, 
-9.928602e-01,1.044207e-01,-3.569758e-03,4.018672e-05,2.687500e+01,3.037500e+01, 
-1.029552e+01,2.685724e+00,-2.204416e-01,5.841658e-03,1.187500e+01,1.487500e+01, 
9.180374e-01,-1.052881e-01,4.064508e-03,-4.967248e-05,1.437500e+01,1.862500e+01, 
-1.418941e-01,4.179488e-02,-2.607750e-03,4.796817e-05,1.837500e+01,2.262500e+01, 
-1.056954e+00,1.409367e-01,-6.036432e-03,8.476716e-05,2.237500e+01,2.637500e+01, 
4.350209e-01,-4.266503e-02,1.486051e-03,-1.785385e-05,2.662500e+01,2.987500e+01, 
 3.455594e+00,-4.364698e-01,1.321818e-02,6.719265e-05,1.162500e+01,1.412500e+01, 
 4.301526e-02,6.098664e-02,-6.465994e-03,1.720728e-04,1.412500e+01,1.787500e+01, 
-4.069651e-01,8.051603e-02,-4.498530e-03,7.871984e-05,1.837500e+01,2.212500e+01, 
-2.809479e-01,4.495355e-02,-2.087645e-03,3.068962e-05,2.212500e+01,2.612500e+01, 
2.075194e+00,-2.261375e-01,8.316833e-03,-1.025206e-04,2.612500e+01,2.912500e+01, 
1.378091e+01,-2.613367e+00,1.675564e-01,-3.613074e-03,1.187500e+01,1.512500e+01, 
2.132854e+00,-3.269693e-01,1.746902e-02,-3.189777e-04,1.437500e+01,1.862500e+01, 
 2.292343e-02,1.849124e-02,-1.524583e-03,3.130647e-05,1.837500e+01,2.262500e+01, 
1.293551e-01,-5.126469e-03,-5.540647e-05,3.265263e-06,2.237500e+01,2.637500e+01, 
9.596848e-01,-9.858289e-02,3.466541e-03,-4.118061e-05,2.612500e+01,2.987500e+01, 
3.097831e+00,-3.674073e-01,1.202461e-02,-5.622977e-05,1.312500e+01,1.662500e+01, 
2.897233e+00,-4.418207e-01,2.304895e-02,-4.059865e-04,1.537500e+01,1.987500e+01, 
9.321359e-01,-1.104539e-01,4.572031e-03,-6.476785e-05,1.937500e+01,2.387500e+01, 
5.252174e-01,-5.379442e-02,1.934598e-03,-2.379672e-05,2.312500e+01,2.737500e+01, 
8.398420e-02,-4.740480e-03,1.085812e-04,-1.047917e-06,2.712500e+01,3.062500e+01};

  if(theCrystal==11 ){
    int idx = theSubR*6;
    for(int j=0;j<4;j++)EXPAN[j]=DC_11[idx+j];
    LOWLIM = DC_11[idx+4];
    HIGLIM = DC_11[idx+5];
  }

  double DC_12[150]={
-2.683156e+02,8.379351e+01,-8.574764e+00,2.894498e-01,9.050000e+00,1.075000e+01, 
-2.633331e+01,1.092268e+01,-1.292598e+00,4.755764e-02,6.550000e+00,1.035000e+01, 
1.298892e+01,-3.890416e+00,5.668730e-01,-3.049368e-02,6.150000e+00,9.650000e+00, 
-2.060104e+01,8.805762e+00,-1.033988e+00,3.720978e-02,6.750000e+00,1.035000e+01, 
-1.435412e+01,6.805584e+00,-8.083018e-01,2.889051e-02,8.950000e+00,1.175000e+01, 
-3.833305e+00,2.751720e+00,-3.176925e-01,9.607317e-03,6.750000e+00,1.045000e+01, 
4.728438e+00,-2.525736e-01,2.442477e-02,-2.816163e-03,3.750000e+00,8.150000e+00, 
4.288562e+00,-1.554985e-02,-2.635850e-02,1.261286e-03,2.250000e+00,5.950000e+00, 
 3.686623e+00,3.032598e-01,-6.954155e-02,2.280268e-03,3.650000e+00,7.750000e+00, 
-2.662604e+01,1.074988e+01,-1.242449e+00,4.460082e-02,6.950000e+00,1.025000e+01, 
1.766374e+01,-5.546134e+00,7.526374e-01,-3.663364e-02,6.150000e+00,9.650000e+00, 
4.038846e+00,9.220826e-02,-2.985477e-02,-1.532897e-04,2.550000e+00,6.050000e+00, 
4.249283e+00,-1.329959e-01,6.910265e-02,-1.731542e-02,4.500000e-01,2.550000e+00, 
 3.261831e+00,6.685430e-01,-1.667045e-01,1.010852e-02,2.450000e+00,5.950000e+00, 
5.532059e+00,-9.222027e-01,1.754193e-01,-1.345344e-02,6.150000e+00,9.750000e+00, 
-2.055600e+00,2.167494e+00,-2.521345e-01,7.175688e-03,6.650000e+00,1.015000e+01, 
5.174107e+00,-5.126735e-01,7.574543e-02,-5.924821e-03,3.650000e+00,8.050000e+00, 
 4.010604e+00,1.421902e-01,-4.961370e-02,2.240491e-03,2.250000e+00,6.150000e+00, 
4.916210e+00,-3.532186e-01,4.486601e-02,-4.190666e-03,3.550000e+00,8.050000e+00, 
-2.613829e+01,1.079982e+01,-1.267882e+00,4.601785e-02,6.750000e+00,1.035000e+01, 
-4.515550e+01,1.533485e+01,-1.592294e+00,5.292917e-02,8.850000e+00,1.125000e+01, 
-4.781856e+00,3.219430e+00,-3.851064e-01,1.279027e-02,6.650000e+00,1.055000e+01, 
1.578993e+01,-4.741117e+00,6.368575e-01,-3.092251e-02,6.050000e+00,9.750000e+00, 
-3.026564e-01,1.669273e+00,-2.082128e-01,6.105978e-03,6.750000e+00,1.055000e+01, 
-8.954002e+01,2.883563e+01,-2.949398e+00,9.773130e-02,8.850000e+00,1.085000e+01};

  if(theCrystal==12 ){
    int idx = theSubR*6;
    for(int j=0;j<4;j++)EXPAN[j]=DC_12[idx+j];
    LOWLIM = DC_12[idx+4];
    HIGLIM = DC_12[idx+5];
  }

  double DC_13[150]={
 5.823157e-02,8.400130e-03,-7.188907e-04,1.284352e-05,2.762500e+01,2.987500e+01, 
-9.805682e-01,1.246907e-01,-5.121338e-03,6.911245e-05,2.312500e+01,2.687500e+01, 
-7.683050e-01,1.241994e-01,-6.228905e-03,1.008285e-04,1.937500e+01,2.362500e+01, 
1.323685e+00,-1.796862e-01,8.574237e-03,-1.410417e-04,1.562500e+01,2.012500e+01, 
3.842282e+01,-7.223355e+00,4.554104e-01,-9.610130e-03,1.312500e+01,1.662500e+01, 
-1.799641e+00,1.999533e-01,-7.304839e-03,8.831979e-05,2.637500e+01,2.937500e+01, 
-1.224227e-01,2.381588e-02,-1.175947e-03,1.772012e-05,2.212500e+01,2.612500e+01, 
1.595430e-01,-1.716654e-03,-5.677470e-04,1.641045e-05,1.837500e+01,2.262500e+01, 
-4.989548e-01,1.477504e-01,-1.091511e-02,2.433065e-04,1.437500e+01,1.862500e+01, 
1.119539e+01,-1.692326e+00,7.848095e-02,-1.002662e-03,1.187500e+01,1.487500e+01, 
3.947799e+00,-4.347167e-01,1.604157e-02,-1.977770e-04,2.612500e+01,2.887500e+01, 
2.737905e-01,-2.446521e-02,7.749894e-04,-8.447286e-06,2.212500e+01,2.587500e+01, 
 3.026276e-02,2.014191e-02,-1.780413e-03,3.846147e-05,1.812500e+01,2.212500e+01, 
-1.783688e-01,8.619931e-02,-6.949675e-03,1.578522e-04,1.412500e+01,1.812500e+01, 
-7.611232e-01,9.620214e-01,-1.215449e-01,4.094543e-03,1.187500e+01,1.412500e+01, 
-6.230283e-01,6.955968e-02,-2.494942e-03,2.924737e-05,2.637500e+01,2.937500e+01, 
3.913277e-01,-3.816143e-02,1.305127e-03,-1.525915e-05,2.212500e+01,2.662500e+01, 
-5.825958e-02,2.959953e-02,-2.055292e-03,3.970729e-05,1.837500e+01,2.237500e+01, 
-8.518330e-01,2.124466e-01,-1.478244e-02,3.191030e-04,1.437500e+01,1.887500e+01, 
-1.286301e+01,3.628803e+00,-3.126392e-01,8.556526e-03,1.187500e+01,1.487500e+01, 
-3.598106e+00,3.811311e-01,-1.337326e-02,1.558978e-04,2.712500e+01,3.012500e+01, 
5.432891e-01,-5.538775e-02,1.960782e-03,-2.363140e-05,2.312500e+01,2.737500e+01, 
-2.203707e-01,5.129646e-02,-3.001136e-03,5.319389e-05,1.912500e+01,2.387500e+01, 
1.654851e+00,-2.281407e-01,1.095303e-02,-1.803335e-04,1.537500e+01,2.012500e+01, 
-2.960648e+00,1.079644e+00,-9.709813e-02,2.591611e-03,1.312500e+01,1.662500e+01};


  if(theCrystal==13 ){
    int idx = theSubR*6;
    for(int j=0;j<4;j++)EXPAN[j]=DC_13[idx+j];
    LOWLIM = DC_13[idx+4];
    HIGLIM = DC_13[idx+5];
  }




}


//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
