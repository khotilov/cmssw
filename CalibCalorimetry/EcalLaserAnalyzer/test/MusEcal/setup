#!/bin/bash

# argument = cfgFile

source $1
export HERE=${PWD}

export MEPERIOD=$LMF_LASER_PERIOD
echo $MEPERIOD

export MUSECAL=${MON_MUSECAL_DIR}
echo   MUSECAL=${MUSECAL}

export MECALIB=${MON_CALIB_PATH}
export MEAB=${MON_AB_PATH}

echo "MECALIB ="$MECALIB
echo "MEAB    ="$MEAB

export PATH=$ROOTSYS/bin:$PATH
export LD_LIBRARY_PATH=$ROOTSYS/lib:$LD_LIBRARY_PATH
export LD_LIBRARY_PATH=${MUSECAL}/lib:${LD_LIBRARY_PATH}
export PATH=${MUSECAL}:${PATH}
export PATH=${MUSECAL}/bin:${PATH}

if [ -z $ROOTSYS ]; then
    echo "Warning ROOTSYS is not yet defined"
else    
    echo "ROOTSYS="$ROOTSYS
fi

#
# specific initializations
#

export MEPSDIR=${HERE}/ps
export MELMDAT=${MON_OUTPUT_DIR}/$MEPERIOD
export MELPRIM=${LMF_LASER_PRIM_DIR}/$MEPERIOD

# FIXME

export MESTORE=$MELPRIM
export MENLSSTORE=${LMF_NLS_DIR}/$MEPERIOD

echo 'Laser Monitoring Directory: ' 
echo MELMDAT=$MELMDAT
if [ -d $MELMDAT ] 
then
    echo '... OK'
else
    echo '... is not present -- primitive NTuples cannot be created'
fi


echo 'MusEcal Laser Primitive Directory for the Period: ' 
echo MESTORE=$MESTORE
if [ -d $MESTORE ]; then
    echo '... OK'
else
    echo '... directory does not exist -- create'
    mkdir $MESTORE
    if [ -d $MESTORE ]; then
	echo '... OK'
    else
	echo '...creation failed'
	return
    fi
fi

echo 'MusEcal NLS Directory for the Period: ' 

echo MENLSSTORE=$MENLSSTORE
if [ -d $MENLSSTORE ]; then
    echo '... OK'
else
    echo '... directory does not exist -- create'
    mkdir $MENLSSTORE
    if [ -d $MENLSSTORE ]; then
	echo '... OK'
    else
	echo '...creation failed'
	return
    fi
fi

echo 'MusEcal Laser Primitive Directory: ' 
echo MELPRIM=$MELPRIM
if [ -d $MELPRIM ]; then
    echo '... OK'
else
    echo '... link does not exist -- create'
    ln -s $MESTORE $MELPRIM
    if [ -d $MELPRIM ]; then
	echo '... OK'
    else 
	echo '...creation failed'
	return
    fi
fi


export MECONFIG=${MELMDAT}/meconfig

#fi 




