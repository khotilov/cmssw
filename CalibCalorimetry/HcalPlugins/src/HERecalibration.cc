///////////////////////////////////////////////////////////////////////////////
// File: HERecalibration.cc
// Description: simple helper class containing tabulater/parameterized 
//              function for HE damade recovery for Upgrade studies  
//              evaluated using SimG4CMS/Calo/ HEDarkening   
///////////////////////////////////////////////////////////////////////////////

#include "HERecalibration.h"

HERecalibration::HERecalibration(double integrated_lumi):iLumi(integrated_lumi)
{ }
   
HERecalibration::~HERecalibration() { }

void HERecalibration::setDsegm( std::vector<std::vector<int>> m_segmentation) 
{

  //  std::cout << std::endl << " HERecalibration->setDsegm" << std::endl;

  for (int ieta = 0; ieta < maxEta; ieta++) {
    //    std::cout << "["<< ieta << "]  ieta =" << ieta + 16 << "  ";
    for(int ilay = 0; ilay < maxLay; ilay++) {
      dsegm[ieta][ilay] = m_segmentation[ieta+15][ilay]; // 0 not used
      //      std::cout << dsegm [ieta][ilay];
    }
    //    std::cout << std::endl;
  }

  initialize();

}

double HERecalibration::getCorr(int ieta, int idepth) {

  //  int init_ieta = ieta;
  ieta = abs(ieta)-16; // 0 - 13   

  double cutoff = 100.0;  // cutoff to avoid too big corrections!
  double val    = 0.;
  double lumis[maxLumi] = {0, 500, 1000, 1500, 2000, 2500, 3000, 3500, 
			   4000, 4500, 5000, 5500, 6000, 6500, 7000, 
			   7500, 8000, 8500, 9000, 9500, 10000};
  int ilumi = -1;
  for(int i = 0; i < maxLumi; i++){
    if(iLumi < lumis[i]) {
      if(i == 0) ilumi = 0;
      ilumi = i-1;
      break;
    }
  }
  if(ilumi == -1) ilumi = maxLumi - 2; //more than maximum - extrapolation with last interv.

  //get corr arrays for interpolation
  double corr1 = corr[ilumi][ieta][idepth];
  double corr2 = corr[ilumi+1][ieta][idepth];


  double tmpcorr = (log(corr1)*(lumis[ilumi+1]-iLumi)+log(corr2)*(iLumi-lumis[ilumi]))/(lumis[ilumi+1]-lumis[ilumi]);

  val = exp(tmpcorr);

  /*
  std::cout << "HERecalibration::getCorr  ilumi/ieta/depth = "
	    << ilumi << ", " << ieta << "(" << init_ieta << "), " << idepth 
            << "    corrs 1,2 = " << corr1 << ", " << corr2
	    << "   correction = " << val << std::endl;
  */

  //  hardwired cutoff 
  if(val > cutoff) val = cutoff;

  return val;
}


void HERecalibration::initialize() {

  double dval[maxLumi][maxEta][maxDepth];  // conversion of lval into depths-averaged values 

  for (int i = 0; i < maxLumi; i++) {
    for (int j = 0; j < maxEta; j++) {
      for (int k = 0; k < maxDepth; k++) {
	
	dval[i][j][k] = 0.0;

      }
    }
  }


  double lval[maxLumi][maxEta][maxLay]    // raw table of mean energy in each layer for each ieta and each integrated lumi
    = {    
    //#lumi 0
    {
      {.000000,0.000000,0.001078,0.008848,0.014552,0.011611,0.008579,0.003211,0.002964,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.107991,0.110127,0.081192,0.050552,0.032968,0.022363,0.012158,0.009392,0.006228,0.003650,0.003512,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.676505,0.490168,0.296676,0.171789,0.129949,0.082862,0.058659,0.044634,0.031707,0.019662,0.015764,0.009106,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.722120,1.182322,0.777626,0.551815,0.381650,0.287366,0.209747,0.149539,0.095313,0.072690,0.052678,0.039654,0.026296,0.017126,0.010785,0.009125,0.006478,0.005883}, //tower 19
      {0.000000,2.253261,1.735958,1.188160,0.840946,0.598602,0.468244,0.302274,0.231664,0.155488,0.107260,0.071025,0.052279,0.040206,0.029258,0.016750,0.013793,0.010577,0.005453}, //tower 20
      {0.000000,2.531237,1.890250,1.299543,0.910114,0.669070,0.488073,0.362763,0.261798,0.177501,0.126352,0.089263,0.060376,0.045327,0.028015,0.021607,0.014022,0.010632,0.007277}, //tower 21
      {0.000000,2.864449,2.128851,1.430183,0.997971,0.742801,0.534812,0.386734,0.272178,0.202083,0.151007,0.106616,0.080018,0.055961,0.042164,0.026671,0.017066,0.010679,0.008012}, //tower 22
      {0.000000,3.245071,2.455721,1.654948,1.168912,0.847157,0.620316,0.450344,0.329651,0.237315,0.164873,0.111421,0.076739,0.058448,0.042908,0.026116,0.019845,0.012941,0.009722}, //tower 23
      {0.000000,3.523457,2.661981,1.771658,1.309808,0.945457,0.701592,0.484851,0.369293,0.265011,0.187915,0.131769,0.095761,0.066367,0.047637,0.034704,0.025890,0.019738,0.011549}, //tower 24
      {0.000000,3.927840,3.003811,2.029410,1.449478,1.099043,0.807025,0.585442,0.438498,0.318257,0.227604,0.153886,0.115857,0.088632,0.057335,0.040283,0.031698,0.022189,0.013614},  //tower 25
      {0.000000,4.351642,3.468444,2.368010,1.716175,1.279396,0.944951,0.700572,0.508232,0.371673,0.274277,0.195301,0.136719,0.100344,0.081408,0.057241,0.039744,0.027569,0.017390}, //tower 26
      {0.000000,3.315232,2.799176,1.928155,1.384991,1.040579,0.757341,0.574996,0.419020,0.306780,0.219979,0.160667,0.112313,0.084583,0.068486,0.052088,0.034637,0.023234,0.018230},  //tower 27
       {0.000000,3.960416,3.689421,2.514970,1.835407,1.372355,1.447654,1.087639,0.836911,0.652146,0.507556,0.416950,0.333755,0.283386,0.224336,0.191078,0.169798,0.144836,0.120804}, //tower 28
      {0.000000,1.530837,1.507162,0.977401,0.694320,0.543973,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    
    //#lumi 500
    {
      {0.000000,0.000000,0.001078,0.008845,0.014549,0.011610,0.008578,0.003211,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.107628,0.109838,0.081125,0.050517,0.032950,0.022359,0.012156,0.009391,0.006228,0.003650,0.003512,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.671186,0.486770,0.296081,0.171504,0.129775,0.082817,0.058632,0.044623,0.031700,0.019659,0.015763,0.009106,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.691661,1.177874,0.774954,0.550131,0.381229,0.287082,0.209640,0.149464,0.095269,0.072682,0.052672,0.039652,0.026295,0.017125,0.010784,0.009125,0.006478,0.005883}, //tower 19
      {0.000000,2.200496,1.727537,1.182711,0.837292,0.597776,0.467615,0.302128,0.231554,0.155413,0.107246,0.071016,0.052276,0.040204,0.029256,0.016749,0.013792,0.010577,0.005453}, //tower 20
      {0.000000,2.453190,1.878379,1.291855,0.905030,0.667912,0.487277,0.362520,0.261635,0.177399,0.126328,0.089248,0.060373,0.045325,0.028013,0.021606,0.014021,0.010632,0.007277}, //tower 21
      {0.000000,2.756162,2.111191,1.418915,0.990560,0.741095,0.533658,0.386411,0.271962,0.201927,0.150964,0.106587,0.080010,0.055956,0.042161,0.026670,0.017065,0.010678,0.008012}, //tower 22
      {0.000000,3.084997,2.423781,1.635666,1.156571,0.844271,0.618390,0.449718,0.329222,0.237032,0.164813,0.111383,0.076729,0.058441,0.042903,0.026115,0.019844,0.012940,0.009721}, //tower 23
      {0.000000,3.184345,2.596109,1.731477,1.282733,0.938547,0.697000,0.483480,0.368377,0.264425,0.187778,0.131681,0.095735,0.066350,0.047626,0.034701,0.025887,0.019736,0.011548}, //tower 24
      {0.000000,3.339895,2.882370,1.953999,1.399664,1.085066,0.797449,0.582115,0.436156,0.316683,0.227186,0.153626,0.115779,0.088578,0.057304,0.040273,0.031691,0.022185,0.013612}, //tower 25
      {0.000000,3.564552,3.041616,2.110706,1.552328,1.235499,0.917187,0.690937,0.502343,0.367952,0.273386,0.194713,0.136511,0.100205,0.081303,0.057205,0.039721,0.027555,0.017382}, //tower 26
      {0.000000,2.557997,2.213761,1.541296,1.117119,0.953613,0.697370,0.548091,0.401168,0.294975,0.218531,0.159709,0.111928,0.084312,0.068285,0.051999,0.034583,0.023198,0.018205}, //tower 27
      {0.000000,2.485898,2.356856,1.680009,1.269877,1.181454,1.166355,0.923200,0.724540,0.574043,0.422299,0.350710,0.236991,0.205624,0.165997,0.170938,0.154295,0.132067,0.111461}, //tower 28
      {0.000000,0.629169,0.503884,0.363304,0.286740,0.325841,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 1000
    {
      {0.000000,0.000000,0.001077,0.008843,0.014546,0.011609,0.008578,0.003211,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.107267,0.109550,0.081058,0.050483,0.032932,0.022354,0.012153,0.009391,0.006228,0.003650,0.003512,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.665915,0.483397,0.295487,0.171219,0.129601,0.082773,0.058606,0.044611,0.031694,0.019656,0.015762,0.009106,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.661754,1.173443,0.772291,0.548452,0.380807,0.286798,0.209533,0.149389,0.095225,0.072674,0.052666,0.039650,0.026294,0.017125,0.010784,0.009125,0.006478,0.005883}, //tower 19
      {0.000000,2.148971,1.719157,1.177288,0.833654,0.596950,0.466987,0.301983,0.231445,0.155338,0.107231,0.071007,0.052274,0.040202,0.029255,0.016748,0.013792,0.010577,0.005453}, //tower 20
      {0.000000,2.377563,1.866582,1.284214,0.899974,0.666757,0.486482,0.362277,0.261472,0.177297,0.126304,0.089233,0.060369,0.045322,0.028012,0.021605,0.014020,0.010632,0.007277}, //tower 21
      {0.000000,2.651981,2.093678,1.407737,0.983204,0.739393,0.532506,0.386088,0.271746,0.201772,0.150921,0.106557,0.080003,0.055951,0.042157,0.026669,0.017065,0.010678,0.008012}, //tower 22
      {0.000000,2.933024,2.392272,1.616616,1.144364,0.841396,0.616470,0.449093,0.328795,0.236749,0.164752,0.111346,0.076718,0.058433,0.042898,0.026113,0.019843,0.012940,0.009721}, //tower 23
      {0.000000,2.878448,2.531902,1.692237,1.256241,0.931689,0.692440,0.482114,0.367464,0.263841,0.187640,0.131592,0.095709,0.066334,0.047615,0.034698,0.025885,0.019734,0.011547}, //tower 24
      {0.000000,2.842467,2.766042,1.881490,1.351608,1.071271,0.787988,0.578807,0.433826,0.315117,0.226770,0.153367,0.115702,0.088524,0.057274,0.040262,0.031684,0.022181,0.013610}, //tower 25
      {0.000000,2.919983,2.673083,1.885299,1.406598,1.193399,0.890392,0.681463,0.496534,0.364272,0.272497,0.194126,0.136303,0.100066,0.081198,0.057168,0.039698,0.027541,0.017374}, //tower 26
      {0.000000,1.975560,1.751637,1.232472,0.901361,0.874001,0.642231,0.522497,0.384120,0.283658,0.217094,0.158757,0.111545,0.084043,0.068084,0.051910,0.034528,0.023162,0.018180}, //tower 27
      {0.000000,1.578630,1.531315,1.134213,0.884974,1.018195,0.959524,0.796232,0.633944,0.508598,0.362209,0.303004,0.192843,0.167682,0.136365,0.154694,0.141471,0.121201,0.103324}, //tower 28
      {0.000000,0.260802,0.173048,0.138907,0.121991,0.200882,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 1500
    {
      {0.000000,0.000000,0.001077,0.008840,0.014543,0.011608,0.008577,0.003211,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.106907,0.109263,0.080990,0.050448,0.032915,0.022349,0.012151,0.009390,0.006227,0.003650,0.003512,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.660690,0.480051,0.294895,0.170935,0.129427,0.082729,0.058579,0.044600,0.031688,0.019653,0.015762,0.009105,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.632390,1.169028,0.769638,0.546779,0.380387,0.286515,0.209426,0.149314,0.095182,0.072666,0.052661,0.039648,0.026292,0.017124,0.010784,0.009125,0.006478,0.005883}, //tower 19
      {0.000000,2.098657,1.710818,1.171890,0.830032,0.596126,0.466360,0.301838,0.231335,0.155263,0.107217,0.070998,0.052271,0.040200,0.029253,0.016747,0.013791,0.010577,0.005453}, //tower 20
      {0.000000,2.304279,1.854860,1.276617,0.894947,0.665603,0.485688,0.362034,0.261310,0.177195,0.126281,0.089218,0.060365,0.045319,0.028010,0.021603,0.014019,0.010632,0.007277}, //tower 21
      {0.000000,2.551747,2.076311,1.396648,0.975903,0.737696,0.531357,0.385766,0.271530,0.201617,0.150878,0.106527,0.079995,0.055946,0.042154,0.026668,0.017064,0.010678,0.008012}, //tower 22
      {0.000000,2.788732,2.361187,1.597796,1.132289,0.838531,0.614556,0.448468,0.328368,0.236467,0.164691,0.111308,0.076708,0.058426,0.042893,0.026112,0.019842,0.012939,0.009720}, //tower 23
      {0.000000,2.602460,2.469317,1.653914,1.230319,0.924884,0.687910,0.480752,0.366553,0.263258,0.187502,0.131504,0.095683,0.066317,0.047604,0.034694,0.025883,0.019732,0.011546}, //tower 24
      {0.000000,2.421250,2.654605,1.811766,1.305246,1.057655,0.778641,0.575518,0.431510,0.313559,0.226354,0.153109,0.115624,0.088470,0.057243,0.040251,0.031676,0.022176,0.013608}, //tower 25
      {0.000000,2.392100,2.354287,1.687456,1.276756,1.153010,0.864529,0.672148,0.490803,0.360633,0.271612,0.193541,0.136095,0.099927,0.081094,0.057131,0.039674,0.027527,0.017365}, //tower 26
      {0.000000,1.527130,1.386651,0.985859,0.727521,0.801115,0.591527,0.498148,0.367836,0.272807,0.215666,0.157811,0.111163,0.083774,0.067884,0.051822,0.034474,0.023126,0.018155}, //tower 27
      {0.000000,1.013000,1.009154,0.772951,0.620956,0.878421,0.801582,0.695118,0.559377,0.453090,0.318896,0.267991,0.170514,0.147498,0.120287,0.141516,0.130813,0.111912,0.096211}, //tower 28
      {0.000000,0.109015,0.060965,0.054540,0.053362,0.127260,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 2000
    {
      {0.000000,0.000000,0.001077,0.008838,0.014540,0.011607,0.008577,0.003211,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.106548,0.108976,0.080923,0.050414,0.032897,0.022345,0.012149,0.009389,0.006227,0.003650,0.003512,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.655511,0.476732,0.294303,0.170651,0.129254,0.082685,0.058553,0.044588,0.031682,0.019650,0.015761,0.009105,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.603558,1.164631,0.766994,0.545111,0.379967,0.286232,0.209319,0.149239,0.095138,0.072658,0.052655,0.039647,0.026291,0.017123,0.010784,0.009125,0.006478,0.005883}, //tower 19
      {0.000000,2.049525,1.702520,1.166517,0.826426,0.595302,0.465733,0.301693,0.231226,0.155188,0.107203,0.070989,0.052269,0.040198,0.029252,0.016746,0.013791,0.010577,0.005452}, //tower 20
      {0.000000,2.233266,1.843212,1.269066,0.889947,0.664452,0.484895,0.361791,0.261147,0.177094,0.126257,0.089203,0.060361,0.045317,0.028009,0.021602,0.014018,0.010631,0.007277}, //tower 21
      {0.000000,2.455312,2.059088,1.385647,0.968657,0.736002,0.530211,0.385444,0.271315,0.201461,0.150835,0.106498,0.079988,0.055941,0.042150,0.026667,0.017063,0.010678,0.008012}, //tower 22
      {0.000000,2.651720,2.330522,1.579202,1.120345,0.835676,0.612649,0.447845,0.327942,0.236185,0.164631,0.111271,0.076698,0.058419,0.042888,0.026110,0.019841,0.012938,0.009720}, //tower 23
      {0.000000,2.353413,2.408314,1.616488,1.204953,0.918132,0.683413,0.479394,0.365645,0.262676,0.187365,0.131416,0.095657,0.066301,0.047593,0.034691,0.025880,0.019731,0.011545}, //tower 24
      {0.000000,2.064254,2.547843,1.744717,1.260516,1.044215,0.769406,0.572248,0.429206,0.312009,0.225938,0.152850,0.115547,0.088416,0.057213,0.040240,0.031669,0.022172,0.013606}, //tower 25
      {0.000000,1.959755,2.077991,1.513465,1.160868,1.114254,0.839559,0.662988,0.485148,0.357034,0.270730,0.192958,0.135887,0.099788,0.080989,0.057095,0.039651,0.027514,0.017357}, //tower 26
      {0.000000,1.181540,1.098238,0.788857,0.587407,0.734380,0.544897,0.474982,0.352282,0.262403,0.214249,0.156870,0.110782,0.083506,0.067685,0.051733,0.034420,0.023091,0.018131}, //tower 27
      {0.000000,0.656096,0.672948,0.531149,0.438508,0.758623,0.677208,0.612450,0.496902,0.405506,0.286911,0.241760,0.157847,0.135690,0.110870,0.130756,0.121908,0.103936,0.089974}, //tower 28
      {0.000000,0.045941,0.021991,0.021943,0.023939,0.082661,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
//#lumi 2500
    {
      {0.000000,0.000000,0.001076,0.008835,0.014536,0.011606,0.008576,0.003211,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.106190,0.108690,0.080856,0.050379,0.032879,0.022340,0.012147,0.009389,0.006227,0.003650,0.003512,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.650378,0.473438,0.293714,0.170368,0.129080,0.082641,0.058526,0.044577,0.031675,0.019647,0.015760,0.009105,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.575249,1.160250,0.764359,0.543448,0.379547,0.285949,0.209212,0.149165,0.095095,0.072650,0.052650,0.039645,0.026290,0.017123,0.010784,0.009124,0.006478,0.005883}, //tower 19
      {0.000000,2.001548,1.694262,1.161168,0.822835,0.594480,0.465107,0.301548,0.231117,0.155113,0.107189,0.070980,0.052266,0.040196,0.029250,0.016745,0.013790,0.010577,0.005452}, //tower 20
      {0.000000,2.164454,1.831638,1.261560,0.884976,0.663302,0.484104,0.361549,0.260985,0.176992,0.126233,0.089188,0.060358,0.045314,0.028007,0.021601,0.014017,0.010631,0.007277}, //tower 21
      {0.000000,2.362531,2.042010,1.374733,0.961465,0.734312,0.529067,0.385122,0.271100,0.201306,0.150792,0.106468,0.079981,0.055937,0.042147,0.026666,0.017063,0.010678,0.008011}, //tower 22
      {0.000000,2.521611,2.300269,1.560832,1.108530,0.832831,0.610747,0.447222,0.327516,0.235903,0.164570,0.111233,0.076687,0.058412,0.042884,0.026109,0.019840,0.012937,0.009719}, //tower 23
      {0.000000,2.128634,2.348850,1.579935,1.180131,0.911431,0.678946,0.478040,0.364739,0.262095,0.187228,0.131328,0.095631,0.066284,0.047582,0.034687,0.025878,0.019729,0.011544}, //tower 24
      {0.000000,1.761422,2.445553,1.680236,1.217360,1.030950,0.760283,0.568997,0.426914,0.310466,0.225524,0.152593,0.115470,0.088362,0.057182,0.040230,0.031662,0.022168,0.013603}, //tower 25
      {0.000000,1.605638,1.838061,1.360149,1.057252,1.077055,0.815447,0.653980,0.479570,0.353474,0.269850,0.192376,0.135680,0.099650,0.080885,0.057058,0.039628,0.027500,0.017349}, //tower 26
      {0.000000,0.914954,0.870220,0.631434,0.474439,0.673270,0.502009,0.452940,0.337422,0.252426,0.212841,0.155935,0.110403,0.083239,0.067486,0.051645,0.034366,0.023055,0.018106}, //tower 27
      {0.000000,0.428432,0.453192,0.367691,0.311538,0.655836,0.576888,0.543393,0.443772,0.364336,0.262683,0.221679,0.149797,0.128096,0.104881,0.121912,0.114428,0.097054,0.084485}, //tower 28
      {0.000000,0.019513,0.008104,0.009023,0.010983,0.054909,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 3000
    {
      {0.000000,0.000000,0.001076,0.008833,0.014533,0.011605,0.008576,0.003211,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.105833,0.108405,0.080789,0.050345,0.032862,0.022335,0.012145,0.009388,0.006226,0.003649,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.645291,0.470170,0.293125,0.170085,0.128907,0.082597,0.058500,0.044565,0.031669,0.019644,0.015759,0.009104,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.547453,1.155886,0.761733,0.541790,0.379128,0.285667,0.209105,0.149090,0.095051,0.072642,0.052644,0.039643,0.026289,0.017122,0.010784,0.009124,0.006478,0.005883}, //tower 19
      {0.000000,1.954699,1.686045,1.155844,0.819260,0.593659,0.464483,0.301403,0.231007,0.155038,0.107175,0.070971,0.052263,0.040194,0.029249,0.016744,0.013790,0.010577,0.005452}, //tower 20
      {0.000000,2.097773,1.820137,1.254099,0.880033,0.662155,0.483314,0.361306,0.260823,0.176890,0.126209,0.089173,0.060354,0.045312,0.028006,0.021600,0.014016,0.010631,0.007277}, //tower 21
      {0.000000,2.273265,2.025073,1.363905,0.954327,0.732626,0.527926,0.384800,0.270885,0.201151,0.150748,0.106439,0.079973,0.055932,0.042144,0.026665,0.017062,0.010677,0.008011}, //tower 22
      {0.000000,2.398047,2.270424,1.542684,1.096844,0.829996,0.608851,0.446600,0.327090,0.235622,0.164510,0.111195,0.076677,0.058404,0.042879,0.026108,0.019839,0.012937,0.009719}, //tower 23
      {0.000000,1.925722,2.290887,1.544236,1.155842,0.904781,0.674510,0.476690,0.363836,0.261516,0.187090,0.131240,0.095605,0.066267,0.047571,0.034684,0.025875,0.019727,0.011543}, //tower 24
      {0.000000,1.504309,2.347540,1.618221,1.175720,1.017857,0.751269,0.565765,0.424635,0.308932,0.225111,0.152336,0.115392,0.088308,0.057152,0.040219,0.031655,0.022164,0.013601}, //tower 25
      {0.000000,1.315579,1.629302,1.224783,0.964446,1.041341,0.792159,0.645122,0.474066,0.349953,0.268974,0.191797,0.135473,0.099512,0.080781,0.057022,0.039605,0.027486,0.017341}, //tower 26
      {0.000000,0.709120,0.689861,0.505595,0.383327,0.617307,0.462556,0.431964,0.323225,0.242857,0.211443,0.155006,0.110025,0.082973,0.067288,0.051557,0.034312,0.023019,0.018081}, //tower 27
      {0.000000,0.281792,0.307726,0.256214,0.222585,0.567549,0.494480,0.484706,0.398028,0.328431,0.243845,0.205957,0.144148,0.122776,0.100750,0.114590,0.108108,0.091085,0.079635}, //tower 28
      {0.000000,0.008351,0.003044,0.003782,0.005138,0.037201,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 3500
    {
      {0.000000,0.000000,0.001075,0.008830,0.014530,0.011604,0.008576,0.003211,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.105478,0.108121,0.080722,0.050311,0.032844,0.022331,0.012143,0.009388,0.006226,0.003649,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.640248,0.466927,0.292537,0.169803,0.128735,0.082553,0.058473,0.044554,0.031663,0.019641,0.015759,0.009104,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.520159,1.151538,0.759116,0.540138,0.378709,0.285385,0.208998,0.149015,0.095008,0.072634,0.052639,0.039641,0.026288,0.017122,0.010784,0.009124,0.006478,0.005883}, //tower 19
      {0.000000,1.908950,1.677867,1.150545,0.815701,0.592839,0.463859,0.301258,0.230898,0.154963,0.107161,0.070962,0.052261,0.040192,0.029247,0.016743,0.013789,0.010577,0.005452}, //tower 20
      {0.000000,2.033157,1.808709,1.246682,0.875118,0.661009,0.482526,0.361064,0.260660,0.176789,0.126185,0.089158,0.060350,0.045309,0.028004,0.021599,0.014015,0.010631,0.007276}, //tower 21
      {0.000000,2.187381,2.008278,1.353163,0.947242,0.730944,0.526787,0.384479,0.270670,0.200997,0.150705,0.106409,0.079966,0.055927,0.042140,0.026663,0.017061,0.010677,0.008011}, //tower 22
      {0.000000,2.280690,2.240981,1.524753,1.085284,0.827171,0.606962,0.445979,0.326666,0.235341,0.164449,0.111158,0.076666,0.058397,0.042874,0.026106,0.019838,0.012936,0.009718}, //tower 23
      {0.000000,1.742513,2.234385,1.509369,1.132073,0.898181,0.670104,0.475345,0.362935,0.260939,0.186953,0.131153,0.095579,0.066251,0.047560,0.034680,0.025873,0.019725,0.011542}, //tower 24
      {0.000000,1.285821,2.253619,1.558576,1.135542,1.004934,0.742364,0.562552,0.422369,0.307405,0.224698,0.152079,0.115315,0.088254,0.057121,0.040208,0.031647,0.022160,0.013599}, //tower 25
      {0.000000,1.077977,1.447299,1.105025,0.881176,1.007043,0.769661,0.636410,0.468635,0.346471,0.268101,0.191219,0.135267,0.099374,0.080677,0.056985,0.039581,0.027472,0.017332}, //tower 26
      {0.000000,0.550047,0.547130,0.404969,0.309817,0.566052,0.426260,0.412001,0.309659,0.233679,0.210054,0.154082,0.109648,0.082707,0.067091,0.051469,0.034259,0.022984,0.018057}, //tower 27
      {0.000000,0.186521,0.210414,0.179590,0.159874,0.491637,0.425847,0.434155,0.358247,0.296903,0.228817,0.193368,0.139855,0.118772,0.097684,0.108482,0.102735,0.085882,0.075334}, //tower 28
      {0.000000,0.003599,0.001162,0.001612,0.002445,0.025641,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 4000
    {
      {0.000000,0.000000,0.001075,0.008828,0.014527,0.011603,0.008575,0.003211,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.105124,0.107838,0.080655,0.050276,0.032826,0.022326,0.012141,0.009387,0.006226,0.003649,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.635250,0.463709,0.291951,0.169521,0.128562,0.082509,0.058447,0.044542,0.031657,0.019638,0.015758,0.009104,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.493360,1.147207,0.756509,0.538490,0.378291,0.285103,0.208891,0.148941,0.094965,0.072626,0.052633,0.039639,0.026287,0.017121,0.010784,0.009124,0.006478,0.005883}, //tower 19
      {0.000000,1.864275,1.669729,1.145270,0.812157,0.592020,0.463236,0.301113,0.230789,0.154889,0.107147,0.070953,0.052258,0.040190,0.029246,0.016742,0.013789,0.010576,0.005452}, //tower 20
      {0.000000,1.970542,1.797353,1.239309,0.870230,0.659866,0.481739,0.360822,0.260498,0.176687,0.126161,0.089143,0.060347,0.045306,0.028003,0.021598,0.014014,0.010630,0.007276}, //tower 21
      {0.000000,2.104750,1.991623,1.342506,0.940210,0.729266,0.525650,0.384157,0.270455,0.200842,0.150662,0.106379,0.079958,0.055922,0.042137,0.026662,0.017061,0.010677,0.008011}, //tower 22
      {0.000000,2.169218,2.211934,1.507038,1.073849,0.824355,0.605078,0.445359,0.326242,0.235060,0.164389,0.111120,0.076656,0.058390,0.042869,0.026105,0.019837,0.012935,0.009718}, //tower 23
      {0.000000,1.577064,2.179307,1.475316,1.108813,0.891632,0.665729,0.474003,0.362036,0.260362,0.186816,0.131065,0.095553,0.066234,0.047549,0.034677,0.025870,0.019723,0.011541}, //tower 24
      {0.000000,1.099993,2.163611,1.501205,1.096773,0.992178,0.733566,0.559357,0.420115,0.305887,0.224286,0.151823,0.115238,0.088200,0.057091,0.040198,0.031640,0.022156,0.013597}, //tower 25
      {0.000000,0.883335,1.288303,0.998864,0.806332,0.974098,0.747924,0.627841,0.463276,0.343027,0.267230,0.190643,0.135060,0.099236,0.080573,0.056949,0.039558,0.027458,0.017324}, //tower 26
      {0.000000,0.427004,0.434123,0.324478,0.250489,0.519104,0.392864,0.393000,0.296695,0.224874,0.208675,0.153164,0.109273,0.082443,0.066894,0.051382,0.034205,0.022948,0.018032}, //tower 27
      {0.000000,0.124150,0.144736,0.126550,0.115399,0.426295,0.368094,0.390152,0.323368,0.269057,0.216528,0.183063,0.136392,0.115583,0.095264,0.103346,0.098139,0.081323,0.071506}, //tower 28
      {0.000000,0.001562,0.000450,0.000697,0.001180,0.017937,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 4500
    {
      {0.000000,0.000000,0.001075,0.008825,0.014524,0.011602,0.008575,0.003211,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.104771,0.107555,0.080589,0.050242,0.032808,0.022322,0.012139,0.009386,0.006225,0.003649,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.630296,0.460517,0.291366,0.169239,0.128390,0.082465,0.058420,0.044530,0.031651,0.019635,0.015757,0.009103,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.467046,1.142893,0.753911,0.536848,0.377873,0.284822,0.208785,0.148866,0.094921,0.072618,0.052628,0.039637,0.026286,0.017121,0.010783,0.009124,0.006478,0.005883}, //tower 19
      {0.000000,1.820651,1.661631,1.140019,0.808629,0.591203,0.462613,0.300968,0.230680,0.154814,0.107133,0.070944,0.052256,0.040188,0.029244,0.016741,0.013788,0.010576,0.005452}, //tower 20
      {0.000000,1.909866,1.786069,1.231981,0.865370,0.658724,0.480953,0.360580,0.260336,0.176586,0.126138,0.089128,0.060343,0.045304,0.028001,0.021597,0.014013,0.010630,0.007276}, //tower 21
      {0.000000,2.025249,1.975107,1.331934,0.933231,0.727592,0.524516,0.383836,0.270240,0.200687,0.150619,0.106350,0.079951,0.055917,0.042133,0.026661,0.017060,0.010677,0.008011}, //tower 22
      {0.000000,2.063329,2.183278,1.489536,1.062538,0.821550,0.603200,0.444740,0.325818,0.234780,0.164328,0.111083,0.076646,0.058383,0.042864,0.026103,0.019836,0.012934,0.009717}, //tower 23
      {0.000000,1.427624,2.125618,1.442055,1.086050,0.885134,0.661383,0.472665,0.361140,0.259787,0.186679,0.130977,0.095527,0.066218,0.047538,0.034673,0.025868,0.019721,0.011540}, //tower 24
      {0.000000,0.941805,2.077348,1.446020,1.059363,0.979587,0.724874,0.556181,0.417873,0.304375,0.223875,0.151567,0.115161,0.088146,0.057060,0.040187,0.031633,0.022152,0.013594}, //tower 25
      {0.000000,0.723877,1.149124,0.904566,0.738943,0.942443,0.726917,0.619413,0.457988,0.339621,0.266363,0.190069,0.134855,0.099098,0.080469,0.056912,0.039535,0.027444,0.017316}, //tower 26
      {0.000000,0.331747,0.344607,0.260071,0.202590,0.476097,0.362132,0.374914,0.284306,0.216428,0.207305,0.152252,0.108899,0.082180,0.066698,0.051294,0.034151,0.022913,0.018007}, //tower 27
      {0.000000,0.083043,0.100073,0.089606,0.083682,0.369994,0.319114,0.351536,0.292583,0.244341,0.206245,0.174449,0.133470,0.112929,0.093257,0.098991,0.094182,0.077305,0.068083}, //tower 28
      {0.000000,0.000682,0.000177,0.000305,0.000577,0.012709,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
//#lumi 5000
    {
      {0.000000,0.000000,0.001074,0.008822,0.014520,0.011601,0.008574,0.003211,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.104419,0.107273,0.080522,0.050208,0.032791,0.022317,0.012137,0.009386,0.006225,0.003649,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.625385,0.457349,0.290783,0.168959,0.128218,0.082421,0.058394,0.044519,0.031644,0.019632,0.015756,0.009103,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.441207,1.138595,0.751321,0.535211,0.377455,0.284540,0.208678,0.148791,0.094878,0.072610,0.052622,0.039635,0.026285,0.017120,0.010783,0.009124,0.006478,0.005883}, //tower 19
      {0.000000,1.778050,1.653573,1.134793,0.805116,0.590386,0.461992,0.300824,0.230571,0.154739,0.107119,0.070935,0.052253,0.040185,0.029243,0.016740,0.013788,0.010576,0.005452}, //tower 20
      {0.000000,1.851069,1.774856,1.224695,0.860537,0.657585,0.480168,0.360338,0.260174,0.176485,0.126114,0.089113,0.060339,0.045301,0.028000,0.021596,0.014012,0.010630,0.007276}, //tower 21
      {0.000000,1.948759,1.958728,1.321446,0.926304,0.725921,0.523385,0.383516,0.270026,0.200533,0.150576,0.106320,0.079944,0.055912,0.042130,0.026660,0.017059,0.010676,0.008011}, //tower 22
      {0.000000,1.962736,2.155006,1.472245,1.051349,0.818754,0.601328,0.444122,0.325395,0.234500,0.164268,0.111045,0.076635,0.058375,0.042859,0.026102,0.019835,0.012934,0.009717}, //tower 23
      {0.000000,1.292618,2.073279,1.409569,1.063774,0.878684,0.657068,0.471332,0.360246,0.259213,0.186543,0.130889,0.095501,0.066201,0.047527,0.034670,0.025865,0.019720,0.011539}, //tower 24
      {0.000000,0.807028,1.994666,1.392934,1.023262,0.967160,0.716287,0.553023,0.415644,0.302872,0.223464,0.151311,0.115084,0.088092,0.057030,0.040176,0.031625,0.022148,0.013592}, //tower 25
      {0.000000,0.593235,1.027041,0.820639,0.678162,0.912019,0.706611,0.611123,0.452771,0.336252,0.265499,0.189497,0.134649,0.098960,0.080365,0.056876,0.039512,0.027431,0.017308}, //tower 26
      {0.000000,0.257938,0.273668,0.208516,0.163906,0.436697,0.333848,0.357696,0.272463,0.208323,0.205945,0.151345,0.108526,0.081917,0.066502,0.051207,0.034098,0.022878,0.017983}, //tower 27
      {0.000000,0.055789,0.069507,0.063725,0.060944,0.321432,0.277325,0.317430,0.265266,0.222309,0.197457,0.167107,0.130924,0.110646,0.091530,0.095268,0.090751,0.073745,0.065012}, //tower 28
      {0.000000,0.000300,0.000070,0.000135,0.000285,0.009104,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
  },
    //#lumi 5500
    {
      {0.000000,0.000000,0.001074,0.008820,0.014517,0.011600,0.008574,0.003211,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.104069,0.106991,0.080455,0.050173,0.032773,0.022312,0.012135,0.009385,0.006225,0.003649,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.620518,0.454206,0.290200,0.168678,0.128046,0.082378,0.058367,0.044507,0.031638,0.019629,0.015756,0.009103,0.006647,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.415835,1.134313,0.748741,0.533579,0.377038,0.284259,0.208571,0.148717,0.094834,0.072602,0.052617,0.039633,0.026284,0.017120,0.010783,0.009124,0.006478,0.005882}, //tower 19
      {0.000000,1.736451,1.645554,1.129591,0.801618,0.589571,0.461371,0.300679,0.230462,0.154665,0.107105,0.070926,0.052250,0.040183,0.029241,0.016739,0.013787,0.010576,0.005452}, //tower 20
      {0.000000,1.794091,1.763713,1.217453,0.855731,0.656447,0.479385,0.360096,0.260012,0.176383,0.126090,0.089098,0.060336,0.045299,0.027998,0.021595,0.014011,0.010630,0.007276}, //tower 21
      {0.000000,1.875165,1.942486,1.311040,0.919429,0.724255,0.522255,0.383195,0.269812,0.200379,0.150533,0.106291,0.079936,0.055907,0.042126,0.026659,0.017059,0.010676,0.008010}, //tower 22
      {0.000000,1.867165,2.127115,1.455160,1.040282,0.815969,0.599463,0.443504,0.324973,0.234220,0.164208,0.111008,0.076625,0.058368,0.042854,0.026101,0.019834,0.012933,0.009716}, //tower 23
      {0.000000,1.170627,2.022258,1.377838,1.041973,0.872284,0.652782,0.470002,0.359355,0.258641,0.186406,0.130802,0.095475,0.066184,0.047517,0.034666,0.025863,0.019718,0.011538}, //tower 24
      {0.000000,0.692100,1.915412,1.341865,0.988423,0.954893,0.707803,0.549883,0.413426,0.301376,0.223055,0.151057,0.115007,0.088038,0.056999,0.040165,0.031618,0.022144,0.013590}, //tower 25
      {0.000000,0.486197,0.919735,0.745792,0.623247,0.882773,0.686979,0.602968,0.447622,0.332920,0.264637,0.188927,0.134444,0.098823,0.080262,0.056839,0.039489,0.027417,0.017299}, //tower 26
      {0.000000,0.200701,0.217423,0.167236,0.132653,0.400598,0.307814,0.341303,0.261143,0.200546,0.204594,0.150444,0.108155,0.081655,0.066307,0.051120,0.034045,0.022842,0.017958}, //tower 27
      {0.000000,0.037625,0.048471,0.045502,0.044563,0.279504,0.241504,0.287156,0.240918,0.202598,0.189806,0.160738,0.128649,0.108629,0.090000,0.092056,0.087757,0.070573,0.062244}, //tower 28
      {0.000000,0.000132,0.000028,0.000060,0.000142,0.006584,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 6000
    {
      {0.000000,0.000000,0.001074,0.008817,0.014514,0.011599,0.008573,0.003210,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.103719,0.106711,0.080388,0.050139,0.032755,0.022308,0.012133,0.009385,0.006225,0.003649,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.615694,0.451087,0.289619,0.168398,0.127874,0.082334,0.058341,0.044496,0.031632,0.019626,0.015755,0.009102,0.006646,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.390922,1.130048,0.746170,0.531953,0.376622,0.283979,0.208465,0.148642,0.094791,0.072594,0.052611,0.039632,0.026282,0.017119,0.010783,0.009124,0.006478,0.005882}, //tower 19
      {0.000000,1.695828,1.637574,1.124412,0.798136,0.588757,0.460752,0.300535,0.230353,0.154590,0.107091,0.070917,0.052248,0.040181,0.029240,0.016738,0.013787,0.010576,0.005452}, //tower 20
      {0.000000,1.738877,1.752642,1.210254,0.850952,0.655311,0.478603,0.359855,0.259851,0.176282,0.126066,0.089083,0.060332,0.045296,0.027997,0.021593,0.014010,0.010630,0.007276}, //tower 21
      {0.000000,1.804358,1.926380,1.300717,0.912605,0.722592,0.521129,0.382875,0.269598,0.200224,0.150490,0.106261,0.079929,0.055902,0.042123,0.026658,0.017058,0.010676,0.008010}, //tower 22
      {0.000000,1.776360,2.099598,1.438281,1.029334,0.813193,0.597602,0.442888,0.324551,0.233941,0.164147,0.110970,0.076615,0.058361,0.042849,0.026099,0.019834,0.012932,0.009716}, //tower 23
      {0.000000,1.060376,1.972521,1.346845,1.020638,0.865933,0.648526,0.468676,0.358465,0.258070,0.186269,0.130714,0.095449,0.066168,0.047506,0.034663,0.025860,0.019716,0.011537}, //tower 24
      {0.000000,0.594012,1.839437,1.292732,0.954801,0.942785,0.699421,0.546762,0.411221,0.299888,0.222646,0.150802,0.114930,0.087985,0.056969,0.040155,0.031611,0.022140,0.013588}, //tower 25
      {0.000000,0.398493,0.825224,0.678912,0.573548,0.854650,0.667996,0.594945,0.442541,0.329624,0.263779,0.188358,0.134239,0.098686,0.080159,0.056803,0.039466,0.027403,0.017291}, //tower 26
      {0.000000,0.156278,0.172810,0.134172,0.107395,0.367520,0.283848,0.325695,0.250321,0.193082,0.203252,0.149549,0.107785,0.081394,0.066113,0.051033,0.033991,0.022807,0.017934}, //tower 27
      {0.000000,0.025463,0.033924,0.032611,0.032706,0.243266,0.210681,0.260176,0.219138,0.184908,0.183036,0.155124,0.126578,0.106813,0.088614,0.089261,0.085125,0.067732,0.059739}, //tower 28
      {0.000000,0.000059,0.000011,0.000027,0.000071,0.004800,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 29
    },
    //#lumi 6500
    {
      {0.000000,0.000000,0.001073,0.008815,0.014511,0.011598,0.008573,0.003210,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.103371,0.106431,0.080322,0.050105,0.032738,0.022303,0.012131,0.009384,0.006224,0.003648,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.610911,0.447992,0.289039,0.168119,0.127703,0.082290,0.058314,0.044484,0.031626,0.019623,0.015754,0.009102,0.006646,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.366459,1.125799,0.743608,0.530331,0.376206,0.283698,0.208358,0.148568,0.094748,0.072586,0.052606,0.039630,0.026281,0.017119,0.010783,0.009124,0.006477,0.005882}, //tower 19
      {0.000000,1.656159,1.629633,1.119258,0.794669,0.587943,0.460133,0.300390,0.230244,0.154515,0.107077,0.070908,0.052245,0.040179,0.029238,0.016737,0.013786,0.010576,0.005452}, //tower 20
      {0.000000,1.685371,1.741640,1.203098,0.846200,0.654178,0.477822,0.359613,0.259689,0.176181,0.126042,0.089068,0.060328,0.045293,0.027995,0.021592,0.014009,0.010629,0.007276}, //tower 21
      {0.000000,1.736231,1.910407,1.290476,0.905832,0.720933,0.520005,0.382556,0.269384,0.200070,0.150447,0.106232,0.079921,0.055898,0.042119,0.026657,0.017058,0.010676,0.008010}, //tower 22
      {0.000000,1.690076,2.072450,1.421605,1.018505,0.810426,0.595748,0.442272,0.324129,0.233662,0.164087,0.110933,0.076604,0.058354,0.042844,0.026098,0.019833,0.012932,0.009715}, //tower 23
      {0.000000,0.960715,1.924034,1.316572,0.999758,0.859630,0.644299,0.467355,0.357579,0.257500,0.186133,0.130627,0.095423,0.066151,0.047495,0.034659,0.025858,0.019714,0.011536}, //tower 24
      {0.000000,0.510226,1.766601,1.245461,0.922352,0.930834,0.691140,0.543658,0.409028,0.298408,0.222238,0.150548,0.114853,0.087931,0.056939,0.040144,0.031604,0.022136,0.013585}, //tower 25
      {0.000000,0.326627,0.741812,0.619034,0.528496,0.827601,0.649635,0.587053,0.437527,0.326364,0.262923,0.187792,0.134035,0.098549,0.080055,0.056767,0.039443,0.027389,0.017283}, //tower 26
      {0.000000,0.121774,0.137407,0.107680,0.086976,0.337206,0.261783,0.310832,0.239973,0.185918,0.201920,0.148658,0.107416,0.081134,0.065919,0.050946,0.033938,0.022772,0.017910}, //tower 27
      {0.000000,0.017285,0.023821,0.023452,0.024088,0.211915,0.184080,0.236052,0.199595,0.168988,0.176962,0.150107,0.124665,0.105150,0.087340,0.086808,0.082796,0.065172,0.057464}, //tower 28
      {0.000000,0.000026,0.000005,0.000012,0.000036,0.003525,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 7000
    {
      {0.000000,0.000000,0.001073,0.008812,0.014508,0.011597,0.008572,0.003210,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.103024,0.106152,0.080255,0.050071,0.032720,0.022299,0.012129,0.009383,0.006224,0.003648,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.606171,0.444922,0.288461,0.167840,0.127532,0.082246,0.058288,0.044473,0.031620,0.019620,0.015753,0.009102,0.006646,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.342438,1.121566,0.741055,0.528714,0.375791,0.283418,0.208252,0.148494,0.094704,0.072578,0.052600,0.039628,0.026280,0.017118,0.010783,0.009124,0.006477,0.005882}, //tower 19
      {0.000000,1.617422,1.621730,1.114127,0.791217,0.587131,0.459514,0.300246,0.230135,0.154441,0.107063,0.070899,0.052243,0.040177,0.029237,0.016736,0.013786,0.010576,0.005452}, //tower 20
      {0.000000,1.633520,1.730708,1.195985,0.841475,0.653046,0.477042,0.359372,0.259527,0.176080,0.126019,0.089053,0.060324,0.045291,0.027994,0.021591,0.014008,0.010629,0.007275}, //tower 21
      {0.000000,1.670684,1.894568,1.280316,0.899110,0.719279,0.518883,0.382236,0.269170,0.199916,0.150404,0.106202,0.079914,0.055893,0.042116,0.026656,0.017057,0.010675,0.008010}, //tower 22
      {0.000000,1.608083,2.045667,1.405128,1.007792,0.807670,0.593900,0.441657,0.323709,0.233383,0.164027,0.110896,0.076594,0.058347,0.042839,0.026096,0.019832,0.012931,0.009715}, //tower 23
      {0.000000,0.870609,1.876765,1.287001,0.979322,0.853375,0.640101,0.466037,0.356694,0.256932,0.185996,0.130539,0.095397,0.066135,0.047484,0.034656,0.025855,0.019712,0.011535}, //tower 24
      {0.000000,0.438597,1.696768,1.199978,0.891034,0.919037,0.682958,0.540573,0.406847,0.296935,0.221831,0.150295,0.114776,0.087877,0.056908,0.040133,0.031596,0.022132,0.013583}, //tower 25
      {0.000000,0.267736,0.668045,0.565321,0.487588,0.801577,0.631874,0.579288,0.432579,0.323140,0.262071,0.187227,0.133830,0.098413,0.079952,0.056730,0.039419,0.027375,0.017275}, //tower 26
      {0.000000,0.094954,0.109301,0.086446,0.070463,0.309424,0.241465,0.296677,0.230079,0.179042,0.200596,0.147774,0.107049,0.080875,0.065725,0.050859,0.033885,0.022737,0.017885}, //tower 27
      {0.000000,0.011767,0.016777,0.016919,0.017798,0.184765,0.161061,0.214424,0.182013,0.154626,0.171445,0.145569,0.122878,0.103610,0.086151,0.084636,0.080721,0.062854,0.055388}, //tower 28
      {0.000000,0.000012,0.000002,0.000006,0.000018,0.002605,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 7500
    {
      {0.000000,0.000000,0.001072,0.008810,0.014505,0.011596,0.008572,0.003210,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.102679,0.105874,0.080189,0.050036,0.032702,0.022294,0.012127,0.009383,0.006224,0.003648,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.601472,0.441875,0.287883,0.167562,0.127361,0.082202,0.058262,0.044461,0.031613,0.019617,0.015753,0.009101,0.006646,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.318850,1.117349,0.738511,0.527103,0.375376,0.283139,0.208146,0.148419,0.094661,0.072570,0.052595,0.039626,0.026279,0.017118,0.010783,0.009124,0.006477,0.005882}, //tower 19
      {0.000000,1.579594,1.613866,1.109020,0.787780,0.586320,0.458897,0.300101,0.230026,0.154366,0.107049,0.070890,0.052240,0.040175,0.029235,0.016735,0.013785,0.010576,0.005452}, //tower 20
      {0.000000,1.583273,1.719844,1.188914,0.836776,0.651917,0.476264,0.359131,0.259366,0.175979,0.125995,0.089038,0.060321,0.045288,0.027992,0.021590,0.014007,0.010629,0.007275}, //tower 21
      {0.000000,1.607618,1.878861,1.270237,0.892439,0.717627,0.517764,0.381917,0.268957,0.199763,0.150361,0.106173,0.079907,0.055888,0.042112,0.026655,0.017056,0.010675,0.008010}, //tower 22
      {0.000000,1.530160,2.019243,1.388849,0.997195,0.804923,0.592057,0.441043,0.323288,0.233105,0.163966,0.110858,0.076584,0.058339,0.042835,0.026095,0.019831,0.012930,0.009714}, //tower 23
      {0.000000,0.789124,1.830683,1.258117,0.959321,0.847168,0.635932,0.464723,0.355812,0.256365,0.185860,0.130452,0.095371,0.066118,0.047473,0.034652,0.025853,0.019711,0.011534}, //tower 24
      {0.000000,0.377309,1.629810,1.156212,0.860807,0.907393,0.674875,0.537505,0.404677,0.295469,0.221425,0.150042,0.114699,0.087824,0.056878,0.040123,0.031589,0.022128,0.013581}, //tower 25
      {0.000000,0.219474,0.602676,0.517046,0.450384,0.776535,0.614690,0.571647,0.427695,0.319950,0.261221,0.186664,0.133627,0.098276,0.079849,0.056694,0.039396,0.027362,0.017267}, //tower 26
      {0.000000,0.074090,0.086978,0.069422,0.057103,0.283960,0.222755,0.283196,0.220617,0.172440,0.199282,0.146894,0.106683,0.080617,0.065533,0.050772,0.033832,0.022702,0.017861}, //tower 27
      {0.000000,0.008032,0.011848,0.012242,0.013190,0.161232,0.141099,0.194989,0.166162,0.141642,0.166383,0.141421,0.121193,0.102168,0.085033,0.082698,0.078859,0.060744,0.053488}, //tower 28
      {0.000000,0.000005,0.000001,0.000003,0.000009,0.001936,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 8000
    {
      {0.000000,0.000000,0.001072,0.008807,0.014501,0.011595,0.008571,0.003210,0.002963,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.102334,0.105596,0.080122,0.050002,0.032685,0.022289,0.012125,0.009382,0.006223,0.003648,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.596815,0.438852,0.287307,0.167284,0.127190,0.082159,0.058235,0.044450,0.031607,0.019614,0.015752,0.009101,0.006646,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.295687,1.113148,0.735976,0.525497,0.374961,0.282859,0.208039,0.148345,0.094618,0.072562,0.052589,0.039624,0.026278,0.017117,0.010783,0.009123,0.006477,0.005882}, //tower 19
      {0.000000,1.542654,1.606040,1.103936,0.784359,0.585511,0.458281,0.299957,0.229917,0.154292,0.107035,0.070881,0.052237,0.040173,0.029234,0.016734,0.013785,0.010575,0.005452}, //tower 20
      {0.000000,1.534580,1.709050,1.181884,0.832103,0.650789,0.475487,0.358890,0.259205,0.175878,0.125971,0.089023,0.060317,0.045286,0.027991,0.021589,0.014006,0.010629,0.007275}, //tower 21
      {0.000000,1.546938,1.863285,1.260238,0.885817,0.715980,0.516647,0.381598,0.268743,0.199609,0.150318,0.106143,0.079899,0.055883,0.042109,0.026654,0.017056,0.010675,0.008010}, //tower 22
      {0.000000,1.456101,1.993173,1.372766,0.986713,0.802185,0.590221,0.440430,0.322869,0.232827,0.163906,0.110821,0.076573,0.058332,0.042830,0.026094,0.019830,0.012929,0.009714}, //tower 23
      {0.000000,0.715422,1.785758,1.229902,0.939746,0.841008,0.631791,0.463413,0.354932,0.255800,0.185724,0.130365,0.095345,0.066102,0.047462,0.034649,0.025850,0.019709,0.011533}, //tower 24
      {0.000000,0.324827,1.565603,1.114098,0.831632,0.895900,0.666889,0.534455,0.402520,0.294011,0.221019,0.149789,0.114622,0.087770,0.056848,0.040112,0.031582,0.022124,0.013579}, //tower 25
      {0.000000,0.179922,0.544634,0.473578,0.416495,0.752430,0.598059,0.564130,0.422875,0.316795,0.260375,0.186102,0.133423,0.098140,0.079747,0.056658,0.039373,0.027348,0.017258}, //tower 26
      {0.000000,0.057848,0.069241,0.055768,0.046292,0.260617,0.205522,0.270354,0.211567,0.166102,0.197977,0.146020,0.106318,0.080360,0.065341,0.050686,0.033779,0.022667,0.017837}, //tower 27
      {0.000000,0.005495,0.008389,0.008882,0.009803,0.140813,0.123756,0.177493,0.151842,0.129881,0.161700,0.137596,0.119594,0.100808,0.083972,0.080953,0.077177,0.058813,0.051740}, //tower 28
      {0.000000,0.000002,0.000000,0.000001,0.000005,0.001446,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 8500
    {
      {0.000000,0.000000,0.001072,0.008805,0.014498,0.011594,0.008571,0.003210,0.002962,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.101991,0.105320,0.080056,0.049968,0.032667,0.022285,0.012123,0.009382,0.006223,0.003648,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.592198,0.435852,0.286732,0.167006,0.127020,0.082115,0.058209,0.044438,0.031601,0.019611,0.015751,0.009100,0.006646,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.272942,1.108963,0.733449,0.523895,0.374547,0.282580,0.207933,0.148271,0.094575,0.072554,0.052584,0.039622,0.026277,0.017116,0.010782,0.009123,0.006477,0.005882}, //tower 19
      {0.000000,1.506581,1.598253,1.098876,0.780952,0.584702,0.457665,0.299813,0.229808,0.154218,0.107021,0.070872,0.052235,0.040171,0.029232,0.016734,0.013784,0.010575,0.005452}, //tower 20
      {0.000000,1.487393,1.698323,1.174897,0.827457,0.649663,0.474711,0.358650,0.259044,0.175777,0.125947,0.089008,0.060313,0.045283,0.027990,0.021588,0.014005,0.010628,0.007275}, //tower 21
      {0.000000,1.488555,1.847838,1.250317,0.879245,0.714337,0.515532,0.381279,0.268530,0.199455,0.150275,0.106113,0.079892,0.055878,0.042105,0.026653,0.017055,0.010675,0.008009}, //tower 22
      {0.000000,1.385708,1.967452,1.356874,0.976344,0.799458,0.588390,0.439818,0.322450,0.232550,0.163846,0.110783,0.076563,0.058325,0.042825,0.026092,0.019829,0.012929,0.009713}, //tower 23
      {0.000000,0.648746,1.741960,1.202340,0.920587,0.834895,0.627679,0.462107,0.354055,0.255235,0.185588,0.130278,0.095319,0.066085,0.047451,0.034646,0.025848,0.019707,0.011532}, //tower 24
      {0.000000,0.279849,1.504030,1.073569,0.803471,0.884555,0.658999,0.531423,0.400374,0.292561,0.220614,0.149537,0.114546,0.087716,0.056817,0.040101,0.031574,0.022120,0.013577}, //tower 25
      {0.000000,0.147505,0.492995,0.434367,0.385579,0.729221,0.581963,0.556732,0.418119,0.313675,0.259531,0.185543,0.133220,0.098004,0.079644,0.056621,0.039350,0.027334,0.017250}, //tower 26
      {0.000000,0.045195,0.055142,0.044813,0.037541,0.239217,0.189647,0.258121,0.202911,0.160015,0.196680,0.145152,0.105955,0.080103,0.065149,0.050600,0.033726,0.022632,0.017812}, //tower 27
      {0.000000,0.003767,0.005954,0.006461,0.007304,0.123081,0.108661,0.161713,0.138885,0.119210,0.157334,0.134041,0.118065,0.099516,0.082959,0.079370,0.075648,0.057037,0.050127}, //tower 28
      {0.000000,0.000001,0.000000,0.000001,0.000003,0.001085,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 9000
    {
      {0.000000,0.000000,0.001071,0.008802,0.014495,0.011593,0.008571,0.003210,0.002962,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.101648,0.105044,0.079990,0.049934,0.032650,0.022280,0.012121,0.009381,0.006223,0.003648,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.587622,0.432875,0.286158,0.166730,0.126850,0.082071,0.058182,0.044427,0.031595,0.019607,0.015751,0.009100,0.006646,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.250607,1.104794,0.730932,0.522299,0.374133,0.282301,0.207827,0.148196,0.094531,0.072547,0.052578,0.039620,0.026276,0.017116,0.010782,0.009123,0.006477,0.005882}, //tower 19
      {0.000000,1.471355,1.590504,1.093840,0.777560,0.583895,0.457050,0.299669,0.229700,0.154143,0.107006,0.070863,0.052232,0.040169,0.029231,0.016733,0.013784,0.010575,0.005452}, //tower 20
      {0.000000,1.441665,1.687665,1.167951,0.822837,0.648539,0.473937,0.358409,0.258882,0.175676,0.125924,0.088993,0.060310,0.045280,0.027988,0.021587,0.014004,0.010628,0.007275}, //tower 21
      {0.000000,1.432382,1.832520,1.240475,0.872721,0.712697,0.514420,0.380960,0.268317,0.199302,0.150232,0.106084,0.079884,0.055873,0.042102,0.026652,0.017054,0.010675,0.008009}, //tower 22
      {0.000000,1.318796,1.942075,1.341174,0.966087,0.796740,0.586564,0.439207,0.322031,0.232272,0.163786,0.110746,0.076552,0.058318,0.042820,0.026091,0.019828,0.012928,0.009713}, //tower 23
      {0.000000,0.588412,1.699261,1.175417,0.901835,0.828829,0.623595,0.460805,0.353180,0.254672,0.185452,0.130190,0.095293,0.066069,0.047440,0.034642,0.025845,0.019705,0.011531}, //tower 24
      {0.000000,0.241271,1.444978,1.034566,0.776288,0.873357,0.651204,0.528408,0.398240,0.291117,0.220210,0.149285,0.114469,0.087663,0.056787,0.040091,0.031567,0.022116,0.013574}, //tower 25
      {0.000000,0.120935,0.446964,0.398932,0.357332,0.706870,0.566379,0.549453,0.413423,0.310588,0.258690,0.184985,0.133017,0.097868,0.079542,0.056585,0.039327,0.027320,0.017242}, //tower 26
      {0.000000,0.035332,0.043930,0.036022,0.030453,0.219597,0.175023,0.246466,0.194630,0.154170,0.195393,0.144288,0.105593,0.079847,0.064958,0.050514,0.033673,0.022597,0.017788}, //tower 27
      {0.000000,0.002588,0.004235,0.004711,0.005456,0.107667,0.095503,0.147462,0.127142,0.109513,0.153240,0.130715,0.116598,0.098281,0.081987,0.077925,0.074251,0.055397,0.048634}, //tower 28
      {0.000000,0.000000,0.000000,0.000000,0.000001,0.000817,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 9500
    {
      {0.000000,0.000000,0.001071,0.008800,0.014492,0.011592,0.008570,0.003210,0.002962,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.101307,0.104768,0.079923,0.049900,0.032632,0.022275,0.012119,0.009380,0.006222,0.003648,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.583085,0.429921,0.285586,0.166453,0.126680,0.082028,0.058156,0.044415,0.031588,0.019604,0.015750,0.009100,0.006646,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.228675,1.100641,0.728423,0.520708,0.373720,0.282022,0.207721,0.148122,0.094488,0.072539,0.052573,0.039618,0.026275,0.017115,0.010782,0.009123,0.006477,0.005882}, //tower 19
      {0.000000,1.436955,1.582792,1.088826,0.774182,0.583088,0.456436,0.299525,0.229591,0.154069,0.106992,0.070854,0.052230,0.040167,0.029229,0.016732,0.013783,0.010575,0.005452}, //tower 20
      {0.000000,1.397350,1.677073,1.161047,0.818243,0.647418,0.473164,0.358169,0.258721,0.175575,0.125900,0.088978,0.060306,0.045278,0.027987,0.021586,0.014003,0.010628,0.007275}, //tower 21
      {0.000000,1.378334,1.817330,1.230712,0.866247,0.711062,0.513311,0.380642,0.268104,0.199148,0.150189,0.106054,0.079877,0.055868,0.042098,0.026651,0.017054,0.010674,0.008009}, //tower 22
      {0.000000,1.255189,1.917039,1.325661,0.955940,0.794031,0.584745,0.438596,0.321613,0.231995,0.163725,0.110709,0.076542,0.058310,0.042815,0.026089,0.019827,0.012927,0.009712}, //tower 23
      {0.000000,0.533808,1.657631,1.149117,0.883480,0.822808,0.619539,0.459507,0.352307,0.254111,0.185316,0.130103,0.095268,0.066052,0.047429,0.034639,0.025843,0.019703,0.011530}, //tower 24
      {0.000000,0.208157,1.388340,0.997027,0.750047,0.862303,0.643502,0.525410,0.396118,0.289681,0.219807,0.149034,0.114393,0.087609,0.056757,0.040080,0.031560,0.022112,0.013572}, //tower 25
      {0.000000,0.099156,0.405853,0.366854,0.331487,0.685340,0.551290,0.542289,0.408789,0.307535,0.257852,0.184429,0.132815,0.097732,0.079439,0.056549,0.039304,0.027306,0.017234}, //tower 26
      {0.000000,0.027637,0.035011,0.028964,0.024712,0.201606,0.161548,0.235361,0.186708,0.148556,0.194114,0.143430,0.105232,0.079592,0.064768,0.050428,0.033621,0.022563,0.017764}, //tower 27
      {0.000000,0.001781,0.003019,0.003443,0.004084,0.094256,0.084018,0.134574,0.116485,0.100688,0.149379,0.127587,0.115184,0.097097,0.081051,0.076595,0.072965,0.053875,0.047245}, //tower 28
      {0.000000,0.000000,0.000000,0.000000,0.000001,0.000618,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000} //tower 29
    },
    //#lumi 10000
    {
      {0.000000,0.000000,0.001071,0.008797,0.014489,0.011591,0.008570,0.003210,0.002962,0.001775,0.001244,0.000194,0.000159,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}, //tower 16
      {0.100967,0.104494,0.079857,0.049866,0.032614,0.022271,0.012116,0.009380,0.006222,0.003647,0.003511,0.001384,0.002693,0.000171,0.000012,0.000000,0.000000,0.000000,0.000000}, //tower 17
      {0.578588,0.426990,0.285014,0.166177,0.126510,0.081984,0.058130,0.044404,0.031582,0.019601,0.015749,0.009099,0.006646,0.004244,0.003099,0.002173,0.001148,0.001037,0.001255}, //tower 18
      {0.000000,1.207137,1.096504,0.725923,0.519121,0.373308,0.281744,0.207614,0.148048,0.094445,0.072531,0.052567,0.039616,0.026274,0.017115,0.010782,0.009123,0.006477,0.005882}, //tower 19
      {0.000000,1.403363,1.575118,1.083835,0.770820,0.582283,0.455823,0.299381,0.229483,0.153994,0.106978,0.070845,0.052227,0.040165,0.029228,0.016731,0.013783,0.010575,0.005451}, //tower 20
      {0.000000,1.354404,1.666549,1.154184,0.813675,0.646298,0.472392,0.357929,0.258561,0.175475,0.125876,0.088963,0.060302,0.045275,0.027985,0.021584,0.014002,0.010628,0.007275}, //tower 21
      {0.000000,1.326330,1.802267,1.221025,0.859821,0.709430,0.512204,0.380324,0.267891,0.198995,0.150146,0.106025,0.079870,0.055863,0.042095,0.026650,0.017053,0.010674,0.008009}, //tower 22
      {0.000000,1.194717,1.892337,1.310333,0.945903,0.791332,0.582931,0.437986,0.321195,0.231719,0.163665,0.110671,0.076532,0.058303,0.042810,0.026088,0.019826,0.012926,0.009712}, //tower 23
      {0.000000,0.484377,1.617045,1.123424,0.865515,0.816834,0.615511,0.458213,0.351436,0.253550,0.185180,0.130016,0.095242,0.066035,0.047419,0.034635,0.025840,0.019701,0.011529}, //tower 24
      {0.000000,0.179710,1.334014,0.960897,0.724716,0.851393,0.635893,0.522430,0.394007,0.288253,0.219405,0.148783,0.114316,0.087556,0.056726,0.040069,0.031553,0.022108,0.013570}, //tower 25
      {0.000000,0.081304,0.369068,0.337765,0.307806,0.664595,0.536677,0.535238,0.404215,0.304514,0.257017,0.183875,0.132612,0.097597,0.079337,0.056513,0.039281,0.027293,0.017225}, //tower 26
      {0.000000,0.021631,0.027912,0.023296,0.020060,0.185107,0.149130,0.224779,0.179127,0.143164,0.192844,0.142577,0.104872,0.079338,0.064578,0.050342,0.033568,0.022528,0.017740}, //tower 27
      {0.000000,0.001228,0.002156,0.002521,0.003064,0.082579,0.073980,0.122904,0.106801,0.092647,0.145723,0.124629,0.113817,0.095956,0.080146,0.075364,0.071775,0.052457,0.045950}, //tower 28
      {0.000000,0.000000,0.000000,0.000000,0.000000,0.000469,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000}   //tower 29
    }
  };
  
  // coverting energy values from layers into depths 


  //  std::cout << std::endl << " >>> DVAL evaluation " << std::endl;

  for (int ilum = 0; ilum < maxLumi; ilum++) {
    for (int ieta = 0; ieta < maxEta; ieta++) {
      for(int ilay = 0; ilay < maxLay; ilay++) {

        int idepth = dsegm[ieta][ilay]; // idepth = 0 - not used!

	/*
	std::cout << "ilay " << ilay << " -> idepth " << idepth   
	          << "  + lval[" << ilum << "][" << ieta << "][" << ilay << "]"
		  << " " << lval[ilum][ieta][ilay] <<  std::endl;       
	*/
	dval[ilum][ieta][idepth] += lval[ilum][ieta][ilay];

      }
    }
  }
  // calculating table of corrections for each ilumi

  //  std::cout << std::endl << "TABLE of dval (ilum,ieta,idepth) " << std::endl;
 
  for (int ilum = 0; ilum < maxLumi; ilum++) {
    for (int ieta = 0; ieta < maxEta; ieta++) {
      for(int idepth = 1; idepth < maxDepth; idepth++) {

        double denom = dval[ilum][ieta][idepth];
        if (denom > 1.e-20) 
	  corr[ilum][ieta][idepth] = dval[0][ieta][idepth] / denom;
	else
          corr[ilum][ieta][idepth] = 1.0;

	/*
        if (idepth > 0 && idepth <= 3) {
	std::cout << "dval[" << ilum << "][" << ieta << "][" << idepth << "]"
		  << " = " << dval[ilum][ieta][idepth] << " - "
		  << "dval[0]["<< ieta << "][" << idepth << "]"
		  << " = " << dval[0][ieta][idepth] 
			  << "    corr = " << corr[ilum][ieta][idepth] << std::endl;
        }
	*/

      }
    }
  }

}
