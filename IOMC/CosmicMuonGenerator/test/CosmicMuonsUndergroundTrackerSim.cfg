process TEST  = {

    untracked PSet configurationMetadata = {
           untracked string version = "$Revision$"
           untracked string name = "$Source$"
           untracked string annotation = "cosmic"
    }

    # initialize  MessageLogger
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
    
    service = RandomNumberGeneratorService {
	untracked uint32 sourceSeed = 9876543
	PSet moduleSeeds = {
	    untracked uint32 g4SimHits = 1234567
	}
    }

    # Monitor
    untracked PSet options = {
	untracked bool wantSummary = true
    }

    #
    # Step 1 : Event Generation
    #
    source = CosMuoGenSource {
	untracked int32 maxEvents = 1000 # deprecated in 1_4_0?
	untracked double MinEn = 10.
	untracked double MinEn_CMS = 7.
	untracked double MaxEn =   10000.
	untracked double MinTheta =  0.
	untracked double MaxTheta = 65. # in grad
	untracked double MinPhi =    0.
	untracked double MaxPhi =  360.
	untracked double MinT0  =  -12.5
	untracked double MaxT0  =   12.5
	untracked double ElossScaleFactor = 1.0
	untracked bool TrackerOnly = false # true: detector with tracker-only setup is used,
	#                                    so no material or B-field outside is considerd
	untracked bool MTCCHalf = false
	# target volume: straight line extrapolation from CMS surface has to hit this volume
	untracked double RadiusOfTarget = 8000. # default  8000.
	untracked double ZDistOfTarget = 15000. # default 15000.
    }

    #
    # Setp 2: Filtering before GEANT4
    #
    include "GeneratorInterface/GenFilters/data/CosmicGenFilterHelix.cfi" # defines cosmicInTracker

    #
    # Step 3: Filtering after SimHits produced.
    #
    module hitsInTk = TrackerMuFilter {
	untracked bool TrackerHits=true
	untracked bool DTMuonHits=false
	untracked bool CSCMuonHits=false
	untracked bool RPCMuonHits=false
    }
    
    #
    # Step 4: Simulation (with vertex smearing disabled and timing of
    # tracker electronics adjusted).
    #
    include "Configuration/StandardSequences/data/Simulation.cff"
    include "Configuration/StandardSequences/data/MixingNoPileUp.cff" 
    # FIXME: following line will become obsolete in some 1_4_0_preX:
    replace g4SimHits.Generator.HepMCProductLabel="source" # no Vtx smearing applied
    
    #
    # Step 5: Event output
    #
    include "Configuration/EventContent/data/EventContent.cff"
    replace FEVTSIMEventContent.outputCommands += "drop *_VtxSmeared_*_*"
    replace FEVTSIMEventContent.outputCommands += "keep *_source_*_*"
    module FEVTSIM = PoolOutputModule { 
	using FEVTSIMEventContent
	untracked string fileName = "file:cosmics_sim.root"
        untracked PSet datasets = {
         untracked PSet dataset1 = {
            untracked string dataTier = "GEN-SIM" 
         }
        }
    }
    
    #
    # Order of execution: Apart from GEANT restrict to tracker.
    #
    endpath p  = {cosmicInTracker, g4SimHits, hitsInTk, 
	FEVTSIM}
}
