#! /bin/env cmsRun

process myPFTauTagAnalyzer = {
  
service = AdaptorConfig {}
source = PoolSource{
  untracked vstring fileNames = { 	
    #'rfio:/castor/cern.ch/cms/store/RelVal/2007/3/20/SVSuite130pre6Tau-DiTaus-DIGI-RECO/0000/6CD49E9D-82D7-DB11-AED9-00304855C45A.root'
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_1.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_2.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_3.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_4.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_5.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_6.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_7.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_8.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_9.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_10.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_11.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_12.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_13.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_14.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_15.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_16.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_17.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_18.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_19.root',
    'rfio:/castor/cern.ch/user/a/azabi/EFLOW/TAU/CMSSW131/singletau_pf_20.root'
  }
  #untracked int32 maxEvents = -1
  untracked int32 maxEvents = 2000
}

include "TrackingTools/TransientTrack/data/TransientTrackBuilder.cfi"
   
# Message Logger
include "FWCore/MessageLogger/data/MessageLogger.cfi"
replace MessageLogger.cout.threshold = "INFO"

#service = Tracer {untracked string indention="$$"}
#service = Timing {}
#service = SimpleMemoryCheck {
#  untracked int32 ignoreTotal = 1 # default is one
#}

# Magnetic Field
include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

# Geometry
include "Geometry/CommonDetUnit/data/globalTrackingGeometry.cfi"
include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"
include "Geometry/CaloEventSetup/data/CaloTopology.cfi"

include "RecoVertex/PrimaryVertexProducer/data/OfflinePrimaryVerticesFromCTFTracks.cfi"

include "RecoTracker/TrackProducer/data/RefitterWithMaterial.cfi"
include "RecoTracker/CkfPattern/data/CkfTrackCandidates.cfi"
include "RecoTracker/TrackProducer/data/CTFFinalFitWithMaterial.cff"
include "TrackingTools/GsfTracking/data/GsfElectronFit.cfi"
include "RecoParticleFlow/PFClusterProducer/data/particleFlowCluster.cff"
include "RecoParticleFlow/PFTracking/data/particleFlowTrack.cff"
include "RecoParticleFlow/PFTracking/data/elecPreId.cff"
include "RecoParticleFlow/PFBlockProducer/data/particleFlowSimParticle.cff"
include "RecoParticleFlow/PFBlockProducer/data/particleFlowBlock.cff"
include "RecoParticleFlow/PFProducer/data/particleFlow.cff"
include "RecoParticleFlow/PFProducer/data/particleFlowJetCandidates.cfi"
     
include "RecoTauTag/PFCombinedTauTag/data/pfConeIsolation.cfi"
include "RecoTauTag/PFCombinedTauTag/data/pfCombinedTauTag.cfi"

# for PDTRecord
#include "SimGeneral/HepPDTESSource/data/pdt.cfi"

# connection to Conditions DB fails, computing likelihood ratios temporarily is not available, PFCombinedTauTagInfo::discriminator() returns -100.
### Begin of DB config #######################################################
#include "CondCore/DBCommon/data/CondDBCommon.cfi"

##replace CondDBCommon.connect = "sqlite_file:tautagnew1.db"  
##replace CondDBCommon.catalog = "file:mycatalog.xml"
#replace CondDBCommon.connect = "oracle://devdb10/CMS_COND_BTAU"    
#replace CondDBCommon.catalog = "relationalcatalog_oracle://devdb10/CMS_COND_GENERAL"            
  
#replace CondDBCommon.DBParameters.messageLevel = 3
#replace CondDBCommon.DBParameters.authenticationPath = "/afs/cern.ch/cms/DB/conddb"
#es_source = PoolDBESSource { 
#  using CondDBCommon
#  #VPSet toGet = { { string record = "CombinedTauTagRcd" string tag = "combinedtautag_tag" } }
#  VPSet toGet = { { string record = "CombinedTauTagRcd" string tag = "combinedtautag_likelihoodratioPDFs_0" } }
#}
#module get = EventSetupRecordDataGetter { 
#  VPSet toGet = { { string record = "CombinedTauTagRcd" vstring data = {"CombinedTauTagCalibration"} } }
#  untracked bool verbose = true 
#}
##### End of DB config #######################################################

module thePFTauTagAnalyzer=PFTauTagAnalyzer{
   #string PFRecTrackProd = "particleFlowTrack"
   string PFRecTrackProd = "elecpreid"
   string PFSimParticleProd = "particleFlow"
   string PFBlockElementTrackProd = "particleFlowBlock"
   string PFCombinedTauTagProd = "pfCombinedTauTag"
   string PVProd = "offlinePrimaryVerticesFromCTFTracks"
   bool test_useOnlyChargedHadrCand = true
   double test_Cand_minpt = 1.5
   bool test_useOnlyChargedHadrforleadPFCand = true
   double test_trackercone_size = 0.5
   double test_matchingcone_size = 0.17
   double test_leadCand_minpt = 6.
   string output_filename = "test.root"
}
# module execution
path p={ctfWithMaterialTracks,offlinePrimaryVerticesFromCTFTracks,particleFlowTrack,particleFlowBlock,particleFlow,particleFlowJetCandidates,iterativeCone5PFJets,mypfConeIsolation,pfCombinedTauTag,thePFTauTagAnalyzer}
}
