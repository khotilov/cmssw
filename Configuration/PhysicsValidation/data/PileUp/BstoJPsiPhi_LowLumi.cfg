process Test = 
{
 # include services
 include "Configuration/ReleaseValidation/data/Services.cfi"

  # initialize  MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"
 
  service = RandomNumberGeneratorService
  {
    untracked uint32 sourceSeed = 98767
      PSet moduleSeeds =
      {
         untracked uint32 VtxSmeared = 123456789
      }

  }

  untracked PSet options = {
     untracked bool makeTriggerResults = false
     vstring listOfTriggers = {}
  }

  source = PythiaSource 
  { 
    untracked int32 maxEvents = 3000000
    untracked int32 pythiaPylistVerbosity = 1 
    untracked bool pythiaHepMCVerbosity = false
    untracked int32 maxEventsToPrint = 0

    PSet PythiaParameters = 
    {

      # This is a vector of ParameterSet names to be read, in this order 
      # The first one sets some defaults 
      # The second one are the user specific parameters 

      vstring parameterSets = 
      { 
        "pythiaUESettings", 
        "myParameters" 
      }

      # CMS default pythia parameters
      include "Configuration/Generator/data/PythiaUESettings.cfi"

      # User cards - name is "myParameters" 
      vstring myParameters =  
      { 

# MSEL=1 is best, but MSEL=5 is faster, so handy for debugging.
        'MSEL=5 ! Heavy quark', 
        #  'MSEL=1',

        # B decays
        'MDME(953,1)=0',
        'MDME(954,1)=0',
        'MDME(955,1)=0',
        'MDME(956,1)=0',
        'MDME(957,1)=0',
        'MDME(958,1)=0',
        'MDME(959,1)=0',
        'MDME(960,1)=0',
        'MDME(961,1)=0',
        'MDME(962,1)=0',
        'MDME(963,1)=0',
        'MDME(964,1)=0',
        'MDME(965,1)=0',
        'MDME(966,1)=0',
        'MDME(967,1)=0',
        'MDME(968,1)=0',
        'MDME(969,1)=0',
        'MDME(970,1)=0',
        'MDME(971,1)=0',
        'MDME(972,1)=0',
        'MDME(973,1)=0',
        'MDME(974,1)=0',
        'MDME(975,1)=0',
        'MDME(976,1)=0',
        'MDME(977,1)=0',
        'MDME(978,1)=0',
        'MDME(979,1)=0',
        'MDME(980,1)=0',
        'MDME(981,1)=0',
        'MDME(982,1)=1 ! Bs->J/psi+phi',
        'MDME(983,1)=0',
        'MDME(984,1)=0',
        'MDME(985,1)=0',
        'MDME(986,1)=0',
        'MDME(987,1)=0',
        'MDME(988,1)=0 ',
        'MDME(989,1)=0',
        'MDME(990,1)=0',
        'MDME(991,1)=0',
 
        # J/psi decays
        'MDME(858,1)=0 ! J/psi->e+e-',
        'MDME(859,1)=1 ! J/psi->mumu',
        'MDME(860,1)=0',

        'MDME(656,1)=1 ! Bs->J/psi+phi',
        'MDME(657,1)=0',
        'MDME(658,1)=0',
        'MDME(659,1)=0',
        'MDME(660,1)=0',
        'MDME(661,1)=0',
        'MDME(662,1)=0 ',
        'MDME(663,1)=0',
        'MDME(664,1)=0',
        'MDME(665,1)=0',
        'MDME(666,1)=0 ! phi->K+K-'
      } 
    }
  }

  module bsFilter = BsJpsiPhiFilter
  {
      int32 leptonType= 13
      double leptonEtaMin = -2.4
      double leptonEtaMax = +2.4 
      double leptonPtMin  = 2.0 
      int32 hadronType= 321
      double hadronEtaMin = -2.4
      double hadronEtaMax = +2.4 
      double hadronPtMin  = 0.8 
  }

  # Primary vertex smearing.
  include "IOMC/EventVertexGenerators/data/VtxSmearedGauss.cfi"

  # Geant4-based detector simulation. 
  include "SimG4Core/Application/data/SimG4Object.cfi"

  # Digitize the hits.
  include "SimG4Core/Application/data/DigiWithEcalZeroSuppression.cff"
#  include "Configuration/Examples/data/DIGI.cff"

 # Pileup.
  include "Configuration/PhysicsValidation/data/Mixing.cff"

 # Reconstruct the event.
  include "Configuration/PhysicsValidation/data/RECO.cff"


  # Order of execution.
  path pf = {bsFilter}
  path p = {bsFilter, VtxSmeared, g4SimHits, mixWithPileUp,  doAllDigiWithEcalZeroSup, reconstruction}  

  # Event output
  include "Configuration/EventContent/data/FEVTOutput.cff"

  module GEN-SIM-DIGI-RECO = PoolOutputModule { 
     untracked string fileName = "PhysVal-BsToJPsiPhi-LowLumi.root"
#     untracked uint32 commitInterval = 10
     using FEVTOutput
     untracked PSet SelectEvents = 
     {
       vstring SelectEvents = { "pf" }
     }
  }

  endpath e = 
  {
    GEN-SIM-DIGI-RECO
  }
}





