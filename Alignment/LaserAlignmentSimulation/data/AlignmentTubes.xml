
<?xmsl version="1.0"?>
<DDDefinition xmlns="http://www.cern.ch/cms/DDL" xmln:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.cern.ch/cms/DDL ../../DDLSchema/DDLSchema.xsd">

	<!-- this file defines the geometry of the Alignment Tubes in the CMS Tracker -->
	<ConstantsSection label="AlignmentTubes.xml" eval="true">
		<Constant name="zero"           value="0.0*fm"/>
		<Constant name="NomexTubeRin2"  value="55.05*cm"/>
		<Constant name="NomexTubeRout2" value="57.75*cm"/>
		<Constant name="AlignPhi1"      value="22.500*deg"/>
		<Constant name="AlignPhi2"      value="73.928*deg"/>
		<Constant name="AlignPhi3"      value="106.071*deg"/>
		<Constant name="AlignPhi4"      value="157.500*deg"/>
		<Constant name="AlignPhi5"      value="208.929*deg"/>
		<Constant name="AlignPhi6"      value="247.500*deg"/>
		<Constant name="AlignPhi7"      value="298.929*deg"/>
		<Constant name="AlignPhi8"      value="331.071*deg"/>
		<Constant name="MirrorPlusPos1" value="180.0*mm"/>
		<Constant name="MirrorPlusPos2" value="220.0*mm"/>
		<Constant name="MirrorPlusPos3" value="380.0*mm"/>
		<Constant name="MirrorPlusPos4" value="580.0*mm"/>
		<Constant name="MirrorPlusPos5" value="620.0*mm"/>
		<Constant name="MirrorPlusPos6" value="1040.0*mm"/>
		<Constant name="MirrorMinusPos1"  value="-1.0*100.0*mm"/>
		<Constant name="MirrorMinusPos2"  value="-1.0*140.0*mm"/>
		<Constant name="MirrorMinusPos3"  value="-1.0*340.0*mm"/>
		<Constant name="MirrorMinusPos4"  value="-1.0*500.0*mm"/>
		<Constant name="MirrorMinusPos5"  value="-1.0*540.0*mm"/>
		<Constant name="MirrorMinusPos6"  value="-1.0*860.0*mm"/>
	</ConstantsSection>
	<SolidSection label="AlignmentTubesNew.xml">
		<!-- define the solids for the alignment tubes -->
		<Tubs name="AlignmentTube" rMin="6.0*mm" rMax="8.0*mm" dz="1135*mm" startPhi="0*deg" deltaPhi="360*deg"/>
		<Tubs name = "Mirror" dz = "0.5*0.6*mm" rMin = "0.0*fm" rMax = "6.0*mm" startPhi = "0*deg" deltaPhi = "360*deg" />
	</SolidSection>

	<LogicalPartSection label = "AlignmentTubes.xml">
		<LogicalPart name="AlignmentTubeL" category="unspecified">
			<rSolid name="AlignmentTubes:AlignmentTube"/>
			<rMaterial name="materials:T_Air"/>
		</LogicalPart>
		<LogicalPart name = "MirrorL" category = "unspecified">
			<rSolid name = "AlignmentTubes:Mirror" />
			<rMaterial name = "materials:Si O_2" />
		</LogicalPart>
	</LogicalPartSection>

	<PosPartSection label = "AlignmentTubes.xml">
		<!-- position the logical parts -->
  		<Algorithm name="track:DDTrackerPhiAlgo">
			<rParent name="tob:TOB"/>
			<String name="ChildName"    value="AlignmentTubes:AlignmentTubeL"/>
			<Numeric name="Radius"      value="([NomexTubeRin2]+[NomexTubeRout2])/2"/>
			<Numeric name="Tilt"        value="0*deg"/>
			<Vector name="Phi" type="numeric" nEntries="8">
				[AlignPhi1], [AlignPhi2], [AlignPhi3], [AlignPhi4],
				[AlignPhi5], [AlignPhi6], [AlignPhi7], [AlignPhi8]
			</Vector>
			<Vector name="ZPos" type="numeric" nEntries="8">
				[zero], [zero], [zero], [zero], [zero], [zero], [zero], [zero]
			</Vector>
		</Algorithm>


<!-- start of the alignment tube (+z direction) -->

  <!-- the first mirror (beam down) -->
  <AlgoPosPart algo="global:angular">
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="180*mm"/>

   <!-- rotate the solid in its local reference frame first,
        then position it acording to angular algorithm.
        There can be up to 3 rotations which are applied in 
        sequence to the solid (this is only for convinience and not
        really necessary).

        In this example the solid first is rotated by 90deg around
        its z-axis and then this resulting solid is again
        rotated by 90deg around the y-axis.

        One rotation consists of 3 parameters: (theta,phi) of the 
        rotation axis and (alpha) - the angle of rotation with respect
        to the axis (theta,phi). -->

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="135*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->

    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
  </AlgoPosPart>

  <!-- the second mirror (beam up) -->
  <AlgoPosPart algo="global:angular" >
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="(180 + 40)*mm"/>

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="45*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->
    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
  </AlgoPosPart>

  <!-- the third mirror (beam down) -->
  <AlgoPosPart algo="global:angular" >
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="380*mm"/>

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="135*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->

    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
   </AlgoPosPart>

  <!-- the fourth mirror (beam up) -->
  <AlgoPosPart algo="global:angular" >
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="580*mm"/>

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="45*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->

    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
   </AlgoPosPart>

  <!-- the fifth mirror (beam down) -->
  <AlgoPosPart algo="global:angular" >
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="(580 + 40)*mm"/>

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="135*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->

    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
   </AlgoPosPart>

  <!-- the sixth mirror (beam up) -->
  <AlgoPosPart algo="global:angular" >
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="1040*mm"/>

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="45*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->

    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
   </AlgoPosPart>
<!-- end of the alignment tube (+z direction) -->

<!-- start of the alignment tube (-z direction) -->
  <!-- the first mirror (beam down) -->
  <AlgoPosPart algo="global:angular" >
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="-1*100*mm"/>

   <!-- rotate the solid in its local reference frame first,
        then position it acording to angular algorithm.
        There can be up to 3 rotations which are applied in 
        sequence to the solid (this is only for convinience and not
        really necessary).

        In this example the solid first is rotated by 90deg around
        its z-axis and then this resulting solid is again
        rotated by 90deg around the y-axis.

        One rotation consists of 3 parameters: (theta,phi) of the 
        rotation axis and (alpha) - the angle of rotation with respect
        to the axis (theta,phi). -->

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="135*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->

    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
   </AlgoPosPart>

  <!-- the second mirror (beam up) -->
  <AlgoPosPart algo="global:angular" >
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="-1*(100 + 40)*mm"/>

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="45*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->

    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
   </AlgoPosPart>

  <!-- the third mirror (beam down) -->
  <AlgoPosPart algo="global:angular" >
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="-1*340*mm"/>

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="135*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->

    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
   </AlgoPosPart>

  <!-- the fourth mirror (beam up) -->
  <AlgoPosPart algo="global:angular" >
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="-1*500*mm"/>

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="45*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->

    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
   </AlgoPosPart>

  <!-- the fifth mirror (beam down) -->
  <AlgoPosPart algo="global:angular" >
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="-1*(500 + 40)*mm"/>

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="135*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->

    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
   </AlgoPosPart>

  <!-- the sixth mirror (beam up) -->
  <AlgoPosPart algo="global:angular" >
   <rParent name="AlignmentTubes:AlignmentTubeL"/>
   <rChild name="AlignmentTubes:MirrorL"/>
   <ParE name="n" value="1"/>
   <ParE name="rangeAngle" value="360*deg"/>
   <ParE name="radius" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="0*mm"/>
   <ParE name="center" value="-1*860*mm"/>

    <!-- first rotate the mirror about 45 degrees w.r.t. to the x-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="45*deg"/> 
    <!-- phi = 45*deg: beam up, phi = 135*deg: beam down -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90*deg around (theta,phi) -->

    <!-- second rotation -->
    <!-- rotate the mirror, so it has the appropriate angle w.r.t. the z-axis -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- theta=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- phi=90*deg -->
    <ParE name="rotateSolid" value="90*deg"/>
    <!-- rotate by 90deg around (theta,phi) -->
   </AlgoPosPart>
<!-- end of the alignment tube (-z direction) -->

</PosPartSection>

</DDDefinition>
