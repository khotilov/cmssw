process Pedestals = {
  untracked PSet maxEvents = {untracked int32 input = -1}

  source = PoolSource {
     untracked vstring fileNames = {"file:/uscms_data/d1/cmstb04/GlobalCosmic/data/GlobalMar08_38429_A.root"}
  }

// This version is intended for unpacking files written
// at testbeam and teststands using 20 timesamples
   module hcalDigis = HcalRawToDigi {
   /// At most ten samples can be put into a digi, if there are more
   /// than ten, firstSample and lastSample select which samples
   /// will be copied to the digi
   int32 firstSample = 0
   int32 lastSample = 9
   /// Flag to enable unpacking of calibration channels (default = false)
   untracked bool UnpackCalib = false
   /// Optional filter to remove any digi with "data valid" off, "error" on, 
   /// or capids not rotating
   bool FilterDataQuality = true
   /// Number of the first HCAL FED.  If this is not specified, the
   /// default from FEDNumbering is used.
   untracked int32 HcalFirstFED = 700
   /// FED numbers to unpack.  If this is not specified, all FEDs from
   /// FEDNumbering will be unpacked.
   untracked vint32 FEDs = { 700 }
   untracked bool ComplainEmptyData = false
   InputTag InputLabel = source
   }


  module pedestals = FRPedestalsMaker {
    string PedestalsFile = "pedestals_tests.txt"
    string HistogramsFile = "pedestals_hists.root"
    int32 preSliceFirst = 0
    int32 preSliceLast = 1
    int32 postSliceFirst = 8
    int32 postSliceLast = 9
  }


  path p1 = {hcalDigis, pedestals}

// stuff for the calibration system
  es_module = HcalDbProducer {}

   es_source es_hardcode = HcalHardcodeCalibrations {
     untracked vstring toGet= { "Pedestals", "PedestalWidths", "Gains", "GainWidths", "ChannelQuality", "RespCorrs", "ZSThresholds"}
     untracked bool H2Mode = false
   }

es_source hcalConditions = PoolDBESSource {
   string timetype = "runnumber"
   string connect = "frontier://FrontierProd/CMS_COND_20X_HCAL"
   PSet DBParameters = {
     untracked int32 messageLevel = 0
   }
   VPSet toGet = {
     { string record = "HcalElectronicsMapRcd" string tag = "official_emap_v5_080208" },
     { string record = "HcalQIEDataRcd" string tag = "qie_normalmode_v3" }
   }
 }

}
