<?xml version="1.0"?>
<DDDefinition xmlns="http://www.cern.ch/cms/DDL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.cern.ch/cms/DDL ../../DetectorDescription/Schema/DDLSchema.xsd">
    
<!-- 

== CMS Forward Pixels Geometry ==

 @version 3.02.01 May 30, 2006
 @created Dmitry Onoprienko

== Subsystem or component described by the file ==

Forward pixels endcap (contains two disks inside a service cylinder).

== Root volume and its reference frame ==

Two root volumes are defined:

PixelForwardZPlus  : +Z half of the detector
PixelForwardZMinus : -Z half of the detector

X horizontal
Y vertical
Z along the beam line, pointing away from IP

== Positioning ==

Anchor point of this component is at the IP-side edge of the service cylider, on 
the axis of the detector (see annotated drawings).
The file defines [AnchorZ] constant that corresponds to the Z coordinate
of the anchor point in the forward pixels endcap reference frame, and the
[ZPixelForward] constant equal to the distance from CMS IP to the 
anchor point. 

Therefore, in the CMS globar reference frame,
PixelForwardZPlus has to be positioned at 
(0., 0., [pixfwd:ZPixelForward]-[pixfwd:AnchorZ]) with no rotation, and 
PixelForwardZMinus has to be positioned at
(0., 0., -[pixfwd:ZPixelForward]+[pixfwd:AnchorZ]) 
with pixfwdCommon:Y180 rotation (180 degrees around Y axis).

 -->

<!-- Root volumes -->

<ConstantsSection label="Root" eval="true">

 <Constant name="RootRadius"       value="[pixfwdCylinder:CylindersOuterRmax]"/>
 <Constant name="RootHalfLength"   value="[pixfwdCylinder:CylindersOuterLength]/2."/>

 <Constant name="AnchorZ"          value="-[RootHalfLength]"/>
 <Constant name="ZPixelForward"    value="325.*mm"/>
 
</ConstantsSection>

<SolidSection label="Root">
 <Tubs name="PixelForward" rMin="0." rMax="[RootRadius]" dz="[RootHalfLength]" startPhi="0." deltaPhi="360*deg" />
</SolidSection>
 
<LogicalPartSection label="Root">
 <LogicalPart name="PixelForwardZPlus" category="envelope">
  <rSolid name="PixelForward"/>
  <rMaterial name="materials:Air"/>
 </LogicalPart>
 <LogicalPart name="PixelForwardZMinus" category="envelope">
  <rSolid name="PixelForward"/>
  <rMaterial name="materials:Air"/>
 </LogicalPart>
</LogicalPartSection>


<!-- Position disks inside root -->

<ConstantsSection label="Disks" eval="true"> <!-- Distances from IP-side edge of PixelForwardRoot to disk centers -->
 <Constant name="Disk1Z"      value= "30*mm"/>
 <Constant name="Disk2Z"      value="160*mm"/>
 <Constant name="Disk3Z"      value="290*mm"/>
</ConstantsSection>
 
<PosPartSection label="Disks">

  <!-- +Z endcap -->

  <PosPart copyNumber="1">
    <rParent name="PixelForwardZPlus"/>
    <rChild name="pixfwdDisk:PixelForwardDiskZPlus"/>
    <Translation x="0." y="0." z="-[RootHalfLength] + [Disk1Z]" />
  </PosPart>
  
  <PosPart copyNumber="2">
    <rParent name="PixelForwardZPlus"/>
    <rChild name="pixfwdDisk:PixelForwardDiskZPlus"/>
    <Translation x="0." y="0." z="-[RootHalfLength] + [Disk2Z]" />
  </PosPart>
  
<!-- UNCOMMENT TO SIMULATE THE THIRD DISK -->
<!--  <PosPart copyNumber="3">-->
<!--    <rParent name="PixelForwardZPlus"/>-->
<!--    <rChild name="pixfwdDisk:PixelForwardDiskZPlus"/>-->
<!--    <Translation x="0." y="0." z="-[RootHalfLength] + [Disk3Z]" />-->
<!--  </PosPart>-->

  <!-- -Z endcap -->

  <PosPart copyNumber="1">
    <rParent name="PixelForwardZMinus"/>
    <rChild name="pixfwdDisk:PixelForwardDiskZMinus"/>
    <Translation x="0." y="0." z="-[RootHalfLength] + [Disk1Z]" />
  </PosPart>
  
  <PosPart copyNumber="2">
    <rParent name="PixelForwardZMinus"/>
    <rChild name="pixfwdDisk:PixelForwardDiskZMinus"/>
    <Translation x="0." y="0." z="-[RootHalfLength] + [Disk2Z]" />
  </PosPart>
  
<!-- UNCOMMENT TO SIMULATE THE THIRD DISK -->
<!--  <PosPart copyNumber="3">-->
<!--    <rParent name="PixelForwardZMinus"/>-->
<!--    <rChild name="pixfwdDisk:PixelForwardDiskZMinus"/>-->
<!--    <Translation x="0." y="0." z="-[RootHalfLength] + [Disk3Z]" />-->
<!--  </PosPart>-->

</PosPartSection>


<!-- Position service cylinders inside root.
  Since shapeless volumes are not useable at the moment, 
  PixelForwardCylinder.xml does the actual positioning, we just tell it where to place the
  cylinders by defining Z position of IP-side edge of service cylinder in PixelForward frame:
-->

<ConstantsSection label="ServiceCylinder" eval="true">
  <Constant name="ZCylinder"   value="-[RootHalfLength]"/>
</ConstantsSection>

<PosPartSection label="Cylinders">

  <!-- +Z endcap -->

  <PosPart copyNumber="1">
    <rParent name="pixfwd:PixelForwardZPlus"/>
    <rChild name="pixfwdCylinder:PixelForwardCylinderOuterCyl"/>
    <Translation x="0." y="0." z="[pixfwd:ZCylinder]+[pixfwdCylinder:CylindersOuterLength]/2." />
  </PosPart>

  <PosPart copyNumber="1">
    <rParent name="pixfwd:PixelForwardZPlus"/>
    <rChild name="pixfwdCylinder:PixelForwardCylinderFrontCyl"/>
    <Translation x="0." y="0." z="[pixfwd:ZCylinder]+[pixfwdCylinder:CylindersFrontLength]/2." />
  </PosPart>

  <PosPart copyNumber="1">
    <rParent name="pixfwd:PixelForwardZPlus"/>
    <rChild name="pixfwdCylinder:PixelForwardCylinderBackCyl"/>
    <Translation x="0." y="0." z="[pixfwd:ZCylinder]+[pixfwdCylinder:CylindersFrontLength]+[pixfwdCylinder:CylinderBackLength]/2." />
  </PosPart>

  <!-- -Z endcap -->

  <PosPart copyNumber="1">
    <rParent name="pixfwd:PixelForwardZMinus"/>
    <rChild name="pixfwdCylinder:PixelForwardCylinderOuterCyl"/>
    <Translation x="0." y="0." z="[pixfwd:ZCylinder]+[pixfwdCylinder:CylindersOuterLength]/2." />
  </PosPart>

  <PosPart copyNumber="1">
    <rParent name="pixfwd:PixelForwardZMinus"/>
    <rChild name="pixfwdCylinder:PixelForwardCylinderFrontCyl"/>
    <Translation x="0." y="0." z="[pixfwd:ZCylinder]+[pixfwdCylinder:CylindersFrontLength]/2." />
  </PosPart>

  <PosPart copyNumber="1">
    <rParent name="pixfwd:PixelForwardZMinus"/>
    <rChild name="pixfwdCylinder:PixelForwardCylinderBackCyl"/>
    <Translation x="0." y="0." z="[pixfwd:ZCylinder]+[pixfwdCylinder:CylindersFrontLength]+[pixfwdCylinder:CylinderBackLength]/2." />
  </PosPart>

</PosPartSection>

    
</DDDefinition>
