<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-15">
  <meta name="author" content="Pietro M. Picca, Pietro.Picca@cern.ch">
  <title>
    Summary of CMS tools: database monitoring and beyond
  </title>
  <style type="text/css">
    @import url(cmspietro.css);
  </style>
</head>

<body onLoad="window.defaultStatus = document.title;">

<p class="aq">
  <script language="JavaScript">
    <!--
    document.write(document.title);
    -->
  </script>
</p>

<a name="mon"></a>

<p class="bo">
  <font class="p2k">
    I. Tools to monitor and futurely to trace the history of CMS condition accounts
  </font>
  <br>
  <ul>
    <li>
      <a href="int2rmon.php" class="p2k" target="_blank">INT2R, a.k.a. CMS_ORCOFF_PREP</a>
    </li>
    <li>
      <a href="int9rmon.php" class="p2k" target="_blank">INT9R, a.k.a. CMS_ORCOFF_INT</a>
    </li>
    <li>
      <a href="cmsrmon.php" class="p2k" target="_blank">CMSR, a.k.a. CMS_ORCOFF_PROD</a>  
    </li>
  </ul>
</p>

<p class="bo">
  These tools show
  <i>at a first level</i>
  some summing up information about condition accounts, such as assigned tablespace for each
  account, occupancy and quota.
  <i>At a second level</i>,
  for each account, it's possible to show more detailed information about any single object
  contained and recent activity, expressed by SQL statements executed and still in servers'
  memory. The instantaneous state is shown, in the moment when user views one of these pages.
</p>

<p class="bo">
  An implementation to store snapshots taken hourly and daily is in progress: soon it will be
  possible to watch the same information hourly during the last 24 hours and daily from the first
  snapshot ever taken. The web interface will be the same, with the addition of a initial menu to
  choose the relevant snapshot.
</p>

<p class="bo">
  Further information is available here:
  <table>
    <tr>
      <td class="sm" width="500">
        <b>
          September 18<sup>th</sup>, 2007, during the CMS Week Offline Database Session
        </b>
      </td>
      <td class="sm">
        <a href="http://indico.cern.ch/getFile.py/access?contribId=43&amp;sessionId=9&amp;resId=3&amp;materialId=slides&amp;confId=21148" class="p2k" target="_blank">Slides in Microsoft PowerPoint format</a>
      </td>
      <td class="sm">
        <a href="http://indico.cern.ch/getFile.py/access?contribId=43&amp;sessionId=9&amp;resId=2&amp;materialId=slides&amp;confId=21148" class="p2k" target="_blank">Slides in Adobe Acrobat format</a>
      </td>
    </tr>
    <tr>
      <td class="sm" width="500">
        <b>
          October 12<sup>th</sup>, 2007, during the CMS Offline Database Session
        </b>
      </td>
      <td class="sm">
        <a href="http://indico.cern.ch/getFile.py/access?contribId=22&amp;sessionId=1&amp;resId=0&amp;materialId=slides&amp;confId=21593" class="p2k" target="_blank">Slides in Microsoft PowerPoint format</a>
      </td>
      <td class="sm">
        <a href="http://indico.cern.ch/getFile.py/access?contribId=22&amp;sessionId=1&amp;resId=1&amp;materialId=slides&amp;confId=21593" class="p2k" target="_blank">Slides in Adobe Acrobat format</a>
      </td>
    </tr>
  </table>
</p>

<br>
<a name="popcon"></a>

<p class="bo">
  <font class="p2k">
    II. PopCon tools
  </font>
  <br>
  <ul>
    <li>
      <a href="popconact.php" class="p2k" target="_blank">Dashboard</a>
    </li>
    <li>
      <a href="popcongraph.php?tc=daily&vw=grp&did=4&quad=20" class="p2k" target="_blank">Sample graph</a>
    </li>
    <li>
      <a href="logtails.php" class="p2k" target="_blank">Cronjob Tail Fetcher</a>
    </li>
    <li>
      <a href="popcononlytable.php" class="p2k" target="_blank">Dashboard (naked output)</a>
    </li>
    <li>
      <a href="popconold.php" class="p2k" target="_blank">Dashboard (old version)</a>
    </li>
  </ul>
</p>

<p class="bo">
  A Twiki page with a detailed explanation about
  <i>the first two items</i>
  and the way to tune several parameters of theirs is available
  <a href="https://twiki.cern.ch/twiki/bin/view/CMS/PopConDashBoard" class="p2k" target="_blank">here</a>.
  <i>Cronjob Tail Fetcher</i>
  lists all the cronjob script log files and for each of them it shows the last lines (5 as
  default, 1000 when expanding). The
  <i>fourth item</i>
  yields the same output as the main dashboard does according to the same parameters selection,
  but without all the HTML framework. The
  <i>last one</i>
  shows the registered activity by the previous PopCon version as long as it was in use.
</p>

<p class="bo">
  Further information is available here:
  <table>
    <tr>
      <td class="sm" width="500">
        <b>
          March 20<sup>th</sup> & 27<sup>th</sup>, 2008, during the CMS Offline Database Sessions
        </b>
      </td>
      <td class="sm">
        <a href="http://indico.cern.ch/getFile.py/access?contribId=9&sessionId=4&resId=0&materialId=slides&confId=28537" class="p2k" target="_blank">Slides in Microsoft PowerPoint format</a>
      </td>
      <td class="sm">
        <a href="http://indico.cern.ch/getFile.py/access?contribId=9&sessionId=4&resId=2&materialId=slides&confId=28537" class="p2k" target="_blank">Slides in Adobe Acrobat format</a>
      </td>
    </tr>
  </table>
</p>

<br>
<a name="misc"></a>

<p class="bo">
  <font class="p2k">
    III. Miscellaneous tools
  </font>
  <br>
  <ul>
    <li>
      <a href="updatepwd.php?svr=int2r" class="p2k" target="_blank">INT2R Password Updater</a>
    </li>
    <li>
      <a href="updatepwd.php?svr=int9r" class="p2k" target="_blank">INT9R Password Updater</a>
    </li>
    <li>
      <a href="http://cmssw.cvs.cern.ch/cgi-bin/cmssw.cgi/CMSSW/CondTools/IntegrationTest/scripts/verifyFrontier?revision=1.1&view=markup" class="p2k" target="_blank">verifyFrontier</a>
    </li>
    <li>
      <a href="javascript:alert('This is a PL/SQL procedure, located on ORCOFF!');" class="p2k">Offline Concise Weekly Report</a>
    </li>
  </ul>
</p>

<p class="bo">
  <i>Password Updaters</i>
  reset all the passwords for condition accounts on the specified server. The actual execution is
  deferred to 6 a.m. two days later than the moment when the script is issued, in order to allow
  operators to update authentication files entries and to warn users about the forthcoming
  changement. Ad hoc authentication is required.
</p>

<p class="bo">
  <i>verifyFrontier</i>
  is a bash script combined with an embedded awk script aimed to parse output FroNTier activity
  log files, in order to identify databases, accounts and payloads involved when processing a
  configuration file given as an input. Total number of queries is calculated, too.
</p>

<p class="bo">
  <i>Offline Concise Weekly Report</i>
  is a procedure periodically sending Pietro an overview of some alarms related to offline
  databases (not only production one), such as forthcoming expiring accounts, heaviest queries
  and some further internal information used to trace that aforementioned scripts are properly
  operational.
</p>

<br>

<p class="bo">
  <font class="p2k">
    IV. To do list
  </font>
  <br>
  <ul>
    <li>
      <i>Short-term project</i>:
       web interface for the gear to trace the history of CMS condition accounts (see point I.)
    </li>
    <li>
      <i>Long-term project</i>:
      graphs to compare different snapshots taken in time to show some trends and their derivative
    </li>
    <li>
      <i>Status</i>:
      structure consisting of tables for containing data to be stored, views, procedures and error handling, is ready, as well as its scheduling (daily and hourly),
      deployment of the successfully tested procedure from INT2R to INT9R done, published documentation on CVS
    </li>
    <li>
      <i>Present week</i>:
      deployment of such procedure to CMSONR (streamed to CMSR), publication of <i>readme.txt</i> files on CVS
    </li>
  </ul>
</p>

<br>

<p class="bo">
  This page has been created on October 24<sup>th</sup>, 2008, and its source code has been last updated on November 11<sup>th</sup>, 2008.
  <br>
  For any suggestion or comment, please write to
  <script language="JavaScript">
    <!--
    document.write("<a href=\"mailto:Pietro M. Picca <Pietro.Picca@cern.ch?subject=" + document.title + "\" class=\"p2k\">Pietro.Picca@cern.ch</a>");
    -->
  </script>.
</p>

</body>

</html>