process ana = {

  source = PoolSource { 
   untracked vstring fileNames = { 
    "file:scratch/bs2mumu.root" 
   }
  }

  untracked PSet maxEvents = {
    untracked int32 input = -1
  }

  # ----------------------------------------------------------------------
  # -- MC Generator candidates
  # ----------------------------------------------------------------------
  include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"
  include "PhysicsTools/HepMCCandAlgos/data/genParticleCandidates.cfi"

  module mcCandidates = CandSelector {
   InputTag src = genParticleCandidates
   string cut = "pt > -1."
   bool filter = false
  }     
 

  # ----------------------------------------------------------------------
  # -- MC truth matching with tracking particles (only on RECO level)
  # ----------------------------------------------------------------------
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
  include "SimTracker/TrackAssociation/data/TrackAssociatorByChi2.cfi"


  # ----------------------------------------------------------------------
  # -- pthat (not necessary for CSA07 samples? see CSA07EventWeightProducer.cc)
  # ----------------------------------------------------------------------
  include "PhysicsTools/HepMCCandAlgos/data/genEventScale.cfi"


  # ----------------------------------------------------------------------
  # -- Candidates
  # ----------------------------------------------------------------------
  include "PhysicsTools/RecoCandAlgos/data/allTracks.cfi"
    replace allTracks.src = ctfWithMaterialTracks

  module goodTracks = CandSelector {
    InputTag src = allTracks
    string cut = "charge != 0"
    bool filter = false
  }     


  # ----------------------------------------------------------------------
  # -- ntuple fillers
  # ----------------------------------------------------------------------
  module tree = HFTree {
    string fileName   = "test.root"    
  } 

  module genDump = HFDumpGenerator {
    untracked string generatorCandidates = "mcCandidates"
    untracked string generatorEvent = "source"
  } 

  module trkDump = HFDumpTracks {
    untracked string tracksLabel            = "ctfWithMaterialTracks"
    untracked string associatorLabel        = "TrackAssociatorByChi2"
    untracked string trackingParticlesLabel = "trackingParticles"
  } 

  module signalDump = HFDumpSignal {
    untracked string tracksLabel            = "goodTracks"
  }


  # ----------------------------------------------------------------------
  # -- The final path
  # ----------------------------------------------------------------------
  path p = { 
             genEventScale,
             genParticleCandidates, mcCandidates, genDump,
             trkDump, 
             allTracks, goodTracks, signalDump, 
             tree 
           }

}
