#run popcon example1

echo "populate 1,11, 21 then  50, 60, 70 then  10, 20, 30??....."
cmsRun $LOCALRT/src/CondCore/PopCon/test/PopConExample1_new.cfg
echo "inspect db"
cmscond_list_iov -c sqlite_file:pop_test.db
echo "get iov details"
cmscond_list_iov -c sqlite_file:pop_test.db -t CSC_tst_tag1 

#note: tag-name, log-name and db-name must be the same as in the cfg file  

echo "dump log"
cmscond_logdb_dump -c sqlite_file:log.db  > test_log1.log

# moving the EXECTIME information from the log
cat test_log1.log | sed 's/EXECTIME (string) : 2008-[0-9]-[0-9][0-9]-[0-9][0-9]:[0-9][0-9]:[0-9][0-9]//g' | sed 's/EXECTIME (string) : 2008-[0-9]-[0-9][0-9]-[0-9][0-9]:[0-9][0-9]:[0-9]//g'| sed 's/EXECTIME (string) : 2008-[0-9]-[0-9][0-9]-[0-9][0-9]:[0-9]:[0-9][0-9]//g' > test_log2.log

rm  test_log1.log
mv test_log2.log test_log1.log
rm pop_test.db
rm log.db
