//FastSimulation headers
#include "FastSimulation/Calorimetry/interface/HCALResponse.h"
#include "FastSimulation/Utilities/interface/RandomEngine.h"

//CMSSW headers
#include "FWCore/MessageLogger/interface/MessageLogger.h"
#include<iostream>
#include <math.h>

#define debug 0

using namespace std;
using namespace edm;

HCALResponse::HCALResponse(const edm::ParameterSet& pset,
			   const RandomEngine* engine) :
  random(engine)
{ 
  
  RespPar[HCAL][0][0] =  
    pset.getParameter<double>("HadronBarrelResolution_Stochastic");
  RespPar[HCAL][0][1] =  
    pset.getParameter<double>("HadronBarrelResolution_Constant");
  RespPar[HCAL][0][2] =  
    pset.getParameter<double>("HadronBarrelResolution_Noise");

  RespPar[HCAL][1][0] =  
    pset.getParameter<double>("HadronEndcapResolution_Stochastic");
  RespPar[HCAL][1][1] =  
    pset.getParameter<double>("HadronEndcapResolution_Constant");
  RespPar[HCAL][1][2] =  
    pset.getParameter<double>("HadronEndcapResolution_Noise");

  RespPar[VFCAL][0][0] =  
    pset.getParameter<double>("HadronForwardResolution_Stochastic");
  RespPar[VFCAL][0][1] =  
    pset.getParameter<double>("HadronForwardResolution_Constant");
  RespPar[VFCAL][0][2] =  
    pset.getParameter<double>("HadronForwardResolution_Noise");

  RespPar[VFCAL][1][0] =  
    pset.getParameter<double>("ElectronForwardResolution_Stochastic");
  RespPar[VFCAL][1][1] =  
    pset.getParameter<double>("ElectronForwardResolution_Constant");
  RespPar[VFCAL][1][2] =  
    pset.getParameter<double>("ElectronForwardResolution_Noise");

  eResponseScale[0] = 
    pset.getParameter<double>("eResponseScaleHB");  
  eResponseScale[1] = 
    pset.getParameter<double>("eResponseScaleHE");
  eResponseScale[2] = 
    pset.getParameter<double>("eResponseScaleHF");

  eResponsePlateau[0] = 
    pset.getParameter<double>("eResponsePlateauHB");
  eResponsePlateau[1] = 
    pset.getParameter<double>("eResponsePlateauHE");
  eResponsePlateau[2] = 
    pset.getParameter<double>("eResponsePlateauHF");

  eResponseExponent = 
    pset.getParameter<double>("eResponseExponent");

  eResponseCoefficient = 
    pset.getParameter<double>("eResponseCoefficient");

  eResponseCorrection = 
    pset.getParameter<double>("eResponseCorrection");

  // If need - add a small energy to each hadron ...
  eBias = 
    pset.getParameter<double>("energyBias");
  
  
  etaStep = 0.1;
  muStep  = 0.25;

  double  _eGridHDB[maxHDeB]  = {1., 2., 3., 5., 9., 15., 20., 30., 50., 150.,
                                 225., 300. };
  double _etGridHDF[maxHDetF] = {2., 5., 10., 30., 50., 100., 300.};
  double _eGridEM[maxEMe]     = {30., 100., 300., 1000., 3000.};
  double _eGridMU[maxMUet]    = {10., 30., 100., 300.};
  double _etaGridMU[maxMUeta] = {0.3, 0.6, 0.8, 1.25, 1.4, 3.0};


  // new HB parameters and eta-energy 

  double _meanHDB[maxHDeB][maxHDetaB] = {

    { 0.568435 , 0.581157 , 0.535524 , 0.533992 , 0.501348 , 0.486947 , 0.419568 , 0.746564 , 0.723906 , 0.573738 , 0.513449 , 0.50197 , 0.510642 , 0.530663 , 0.513894 , 0.522374 , 0.497763 , 0.509543 , 0.538099 , 0.559572 , 0.578176 , 0.52589 , 0.500291 , 0.512384 , 0.5 , 0.518493 , 0.544268 , 0.469633 , 0.516954 , 0.500546 },

    { 1.49995 , 1.50356 , 1.48182 , 1.43871 , 1.44501 , 1.38695 , 1.38756 , 1.34685 , 1.32376 , 1.25681 , 1.27943 , 1.22469 , 1.29924 , 1.51005 , 1.52364 , 1.49599 , 1.51428 , 1.49413 , 1.52216 , 1.52108 , 1.45148 , 1.52227 , 1.62458 , 1.55357 , 1.50025 , 1.60653 , 1.62089 , 1.48593 , 1.14068 , 1.00029},

    { 2.39071 , 2.39404 , 2.33671 , 2.29248 , 2.30786 , 2.29406 , 2.17728 , 2.20881 , 2.18971 , 2.15036 , 2.14836 , 2.16882 , 2.07845 , 2.21135 , 2.63871 , 2.56163 , 2.43503 , 2.3676 , 2.42444 , 2.52679 , 2.45442 , 2.53011 , 2.41238 , 2.47163 , 2.48197 , 2.63264 , 2.50835 , 2.70113 , 2.51443 , 1.66363},

    { 4.2223 , 4.21688 , 4.24724 , 4.19224 , 4.16865 , 4.14472 , 4.14101 , 4.11577 , 4.10966 , 4.03728 , 3.9883 , 3.9814 , 4.00942 , 3.98234 , 4.68722 , 5.07483 , 4.72215 , 4.5337 , 4.80451 , 4.69918 , 4.68544 , 4.71681 , 4.55891 , 4.5454 , 4.5616 , 4.89283 , 4.73549 , 4.80538 , 4.97887 , 4.17356 },

    { 8.00706 , 8.02172 , 7.82048 , 7.93424 , 7.70879 , 7.92543 , 7.68784 , 7.55889 , 7.65814 , 7.65885 , 7.51355 , 7.44811 , 7.67596 , 7.65921 , 7.94415 , 8.39656 , 9.10504 , 8.81854 , 8.70495 , 8.95899 , 9.09215 , 8.89339 , 8.97297 , 8.99587 , 9.0867 , 8.942 , 9.15767 , 9.1551 , 9.17254 , 8.87461 },

    { 13.4856 , 13.5295 , 13.8898 , 13.5197 , 13.4548 , 13.4268 , 13.1677 , 13.0136 , 13.2002 , 13.1582 , 12.9706 , 12.9237 , 13.3406 , 13.4027 , 13.8355 , 14.5451 , 15.4652 , 15.5071 , 15.442 , 15.4884 , 15.3628 , 15.7552 , 15.491 , 15.6661 , 15.6398 , 15.4681 , 15.8655 , 15.4205 , 15.2068 , 14.9865 },

    { 18.5132 , 18.5305 , 18.536 , 18.4873 , 18.2554 , 18.1009 , 18.3225 , 18.2078 , 17.9741 , 17.8698 , 17.7501 , 17.7858 , 18.032 , 18.4086 , 18.6885 , 20.2262 , 21.2185 , 20.896 , 20.5884 , 21.0642 , 20.8273 , 20.896 , 20.9308 , 21.4422 , 21.0457 , 21.0582 , 21.3619 , 21.0995 , 21.1714 , 20.7916 },

    { 28.4747 , 28.3258 , 28.1125 , 28.0497 , 27.9626 , 28.0129 , 27.7286 , 27.3278 , 27.5628 , 27.3297 , 27.2271 , 27.01 , 27.8585 , 28.3968 , 28.9441 , 31.2056 , 31.9144 , 31.7659 , 31.816 , 32.0362 , 31.9742 , 32.0011 , 32.1656 , 32.605 , 32.2603 , 32.3514 , 32.5371 , 32.2708 , 31.9263 , 32.0019 },

    { 47.6805 , 47.7675 , 47.4529 , 47.4647 , 47.3125 , 47.4544 , 46.6312 , 46.2238 , 46.2357 , 46.1264 , 45.8794 , 46.1385 , 46.825 , 48.0292 , 48.9424 , 54.3691 , 53.7965 , 53.452 , 53.7212 , 53.9765 , 53.1962 , 53.9177 , 53.5088 , 54.1537 , 54.1085 , 53.9163 , 54.3511 , 53.8127 , 53.5989 , 53.2054 },

    { 144.625 , 144.394 , 144.516 , 143.105 , 144.213 , 144.242 , 143.531 , 142.834 , 142.939 , 142.278 , 140.956 , 142.045 , 144.571 , 145.156 , 149.425 , 162.688 , 161.602 , 161.852 , 161.855 , 163.142 , 161.433 , 162.799 , 162.28 , 163.163 , 162.742 , 162.126 , 162.775 , 161.979 , 160.326 , 156.958 },

    { 217.087 , 218.284 , 218.328 , 217.3 , 214.808 , 216.96 , 215.647 , 215.03 , 215.547 , 216.061 , 212.836 , 214.273 , 216.12 , 214.487 , 224.094 , 243.999 , 242.507 , 242.561 , 242.899 , 243.418 , 241.714 , 243.213 , 243.629 , 243.614 , 242.985 , 242.51 , 243.461 , 241.142 , 238.606 , 231.665 },

    {291.674 , 290.466 , 292.702 , 290.401 , 289.927 , 288.303 , 289.992 , 286.985 , 289.207 , 287.936 , 283.787 , 287.869 , 290.324 , 287.984 , 298.522 , 325.847 , 321.912 , 322.189 , 321.571 , 324.811 , 323.23 , 325.465 , 323.672 , 326.213 , 324.048 , 323.579 , 326.608 , 321.704 , 317.602 , 309.905 }

  };

  double _sigmaHDB[maxHDeB][maxHDetaB] = {

    { 0.342228 , 0.374138 , 0.327231 , 0.345981 , 0.293963 , 0.34084 , 0.388163 , 0.941721 , 1.05989 , 0.734312 , 0.638574 , 0.563231 , 0.59309 , 0.598979 , 0.626575 , 0.648912 , 0.619916 , 0.596478 , 0.635296 , 0.777022 , 0.871913 , 0.895345 , 0.988462 , 1.04368 , 1.01333 , 1.04605 , 1.09793 , 0.9576 , 1.02733 , 1.05114 },

    { 0.928427 , 1.08488 , 0.927491 , 0.843929 , 1.0558 , 0.845063 , 0.915855 , 0.866387 , 0.903753 , 0.742495 , 0.839519 , 0.764705 , 1.08534 , 1.29761 , 1.26661 , 1.24474 , 1.4442 , 1.28767 , 1.38876 , 1.30216 , 1.20989 , 1.2644 , 1.41003 , 1.34105 , 1.20819 , 1.36838 , 1.34887 , 1.54547 , 1.68869 , 1.62674  },

    { 1.41162 , 1.39113 , 1.31478 , 1.25917 , 1.35245 , 1.28327 , 1.16481 , 1.38516 , 1.24195 , 1.23447 , 1.23012 , 1.35239 , 1.18784 , 1.61128 , 1.83356 , 1.79739 , 1.69284 , 1.70134 , 1.7352 , 1.70854 , 1.8154 , 1.91254 , 1.66075 , 1.69613 , 1.697 , 1.89169 , 1.60034 , 1.95615 , 2.17286 , 2.05696 },

    { 1.86654 , 1.81119 , 1.86508 , 1.72062 , 1.74672 , 1.73905 , 1.87335 , 2.01479 , 1.95791 , 1.77667 , 1.77758 , 2.05003 , 1.96499 , 1.94731 , 2.59583 , 2.60662 , 2.46954 , 2.42239 , 3.01737 , 2.54338 , 2.57903 , 2.66401 , 2.24359 , 2.23474 , 2.50431 , 2.4851 , 2.29357 , 2.37818 , 2.51982 , 2.91928 },

    { 2.8395 , 2.54548 , 2.68296 , 2.76361 , 2.63107 , 2.77042 , 2.67386 , 2.48073 , 2.60121 , 2.75501 , 2.64946 , 2.5958 , 2.70732 , 2.74449 , 3.17218 , 3.60345 , 3.42717 , 3.30139 , 3.16616 , 3.4608 , 3.64501 , 3.50217 , 3.30312 , 3.57036 , 3.64341 , 3.56217 , 3.39826 , 3.66402 , 3.4394 , 3.7789 },

    { 3.39426 , 3.42109 , 3.90018 , 3.45243 , 3.64641 , 3.56715 , 3.7178 , 3.51378 , 3.60167 , 3.73476 , 3.67249 , 3.59069 , 3.81671 , 3.79389 , 4.54008 , 5.53243 , 4.41706 , 4.73643 , 4.75034 , 4.53349 , 4.61952 , 4.78473 , 4.57724 , 4.78344 , 4.91606 , 4.56105 , 4.71795 , 4.31 , 4.26585 , 5.03259 },

    { 4.32216 , 4.09533 , 4.38134 , 4.2606 , 4.14205 , 4.2183 , 4.3235 , 4.49908 , 4.36486 , 4.33911 , 4.38672 , 4.35319 , 4.41581 , 4.68709 , 5.25832 , 6.50577 , 5.26652 , 5.39547 , 5.19476 , 5.46518 , 5.62934 , 5.1095 , 5.2999 , 5.67409 , 5.49858 , 5.42389 , 5.504 , 5.31651 , 5.39269 , 5.42418 },

    { 5.48177 , 5.32969 , 5.37157 , 5.39433 , 5.55037 , 5.19 , 5.53481 , 5.28595 , 5.53451 , 5.56258 , 5.64761 , 5.50886 , 5.66444 , 5.97257 , 6.46733 , 7.64355 , 6.33066 , 6.55413 , 6.77489 , 6.52854 , 6.68903 , 6.90215 , 6.78808 , 6.88261 , 6.74266 , 6.733 , 6.67561 , 6.88302 , 6.46332 , 6.27923 },

    { 7.44515 , 7.43543 , 7.44724 , 7.62214 , 7.40217 , 7.70899 , 7.44356 , 7.68783 , 7.88456 , 7.71954 , 7.84648 , 8.09682 , 8.07295 , 8.52831 , 8.73395 , 9.86675 , 8.72905 , 8.42843 , 8.9889 , 9.41506 , 8.8164 , 9.1121 , 9.02076 , 9.35131 , 9.09339 , 9.14747 , 8.98791 , 8.99644 , 8.78827 , 8.89997 },

    { 15.3141 , 15.3699 , 14.8072 , 15.5817 , 16.7834 , 16.0866 , 16.7953 , 17.4122 , 17.0883 , 17.6962 , 18.1822 , 18.3855 , 18.0229 , 17.4652 , 16.8176 , 17.1226 , 15.8604 , 16.1167 , 16.4969 , 16.4283 , 16.8649 , 16.8088 , 16.4494 , 16.7188 , 16.9709 , 16.7914 , 17.255 , 16.4888 , 16.3179 , 16.6981 },

    { 20.8543 , 20.6433 , 20.6231 , 21.7353 , 21.9817 , 22.299 , 23.1573 , 24.3929 , 23.013 , 24.0475 , 24.7719 , 24.9448 , 24.8023 , 22.7907 , 23.4438 , 21.2179 , 19.2524 , 20.0071 , 20.1309 , 21.5005 , 19.8266 , 22.4108 , 20.9756 , 21.733 , 22.4184 , 21.1918 , 22.5338 , 22.1481 , 21.5299 , 25.0145  },

    { 26.9621 , 24.5777 , 26.5863 , 27.603 , 27.5768 , 27.154 , 29.6305 , 31.2964 , 30.0699 , 30.8516 , 31.7029 , 32.9043 , 31.4147 , 29.8774 , 29.7229 , 24.9885 , 23.1796 , 23.7512 , 23.9185 , 25.5394 , 24.4471 , 26.2267 , 25.4202 , 26.0496 , 26.3082 , 25.6382 , 26.2608 , 25.7415 , 28.0092 , 29.901 },

  };

  // old HF parameters and eta-et grid 
  // sometimes - too precise, just like it came from printout ...  

  double _meanHDF[maxHDetF][maxHDetaF] = {

    { 1.72481, 1.71607, 1.73071, 1.69458, 1.77888, 1.78425, 1.75436, 1.78725, 1.87764, 1.83765, 1.81408, 1.89184, 1.85836, 1.87247, 1.8646, 1.78507, 1.7724, 1.70668, 1.62427, 1.76511},
   
    { 5.22469, 4.9671, 5.28952, 5.13815, 5.35394, 5.34329, 5.26225, 5.40104, 5.33468, 5.3519, 5.24724, 5.30481, 5.05893, 4.93604, 4.87402, 4.62679, 4.76472, 4.60116, 4.68426, 4.33045 },

    { 10.759, 10.5922, 11.3817, 11.1463, 11.3032, 11.3331, 10.8891, 11.0871, 10.9791, 11.1042, 10.7969, 11.1019, 10.8262, 10.0955, 10.4024, 9.41198, 9.45667, 9.38563, 9.48742, 9.07623 },

    { 35.5651, 34.7344, 36.7311, 36.0769, 36.4205, 36.2927, 36.0602, 36.5526, 35.9435, 36.1103, 35.533, 35.5981, 34.744, 33.0079, 33.4431, 29.8716, 28.2019, 26.523, 28.4465, 28.2827 },

    { 55.6453, 55.7636, 57.6321, 56.4545, 56.7876, 56.3377, 55.6879, 56.2179, 54.8244, 55.3925, 54.8871, 54.7371, 53.2685, 51.6678, 52.0687, 47.1896, 43.6761, 40.1869, 42.8487, 43.4443},

    { 107.596, 107.96, 109.43, 107.894, 108.562, 108.224, 107.3, 108.26, 106.661, 106.498, 104.782, 105.515, 103.341, 99.9445, 99.6927, 91.1985, 83.5148, 73.4813, 81.6298, 84.4643 },

    { 330, 330, 330, 330, 330, 330, 330, 330, 330, 330, 330, 330, 330, 330, 330, 330, 330, 330, 330, 330 }
  };

  double _sigmaHDF[maxHDetF][maxHDetaF] = {

    { 0.842804, 0.832992, 0.70721, 0.706302, 0.694817, 0.688575, 0.662423, 0.589267, 0.654093, 0.618051, 0.526045, 0.543144, 0.515212, 0.551783, 0.519453, 0.663107, 0.497675, 0.596644, 0.573251, 0.427364},
      
    { 1.69583, 1.48187, 1.47732, 1.40701, 1.48612, 1.26917, 1.34044, 1.2543, 1.28569, 1.25219, 1.13289, 1.27917, 1.09344, 1.15541, 1.09778, 1.21229, 1.11381, 1.07572, 0.984415, 0.909833 },

    { 2.48231, 2.29836, 2.19089, 2.3125, 2.11164, 1.75669, 2.1452, 2.04578, 2.06963, 1.87146, 2.08008, 2.03519, 2.00319, 2.28931, 2.22979, 2.55083, 2.4767, 2.44471, 1.89115, 1.55137 },

    { 6.32303, 5.63618, 4.87904, 4.58962, 5.71972, 5.32256, 4.7164, 4.35502, 4.35531, 4.47801, 4.32158, 4.93618, 4.30219, 5.56533, 5.02983, 6.67571, 7.63136, 7.27706, 6.22843, 4.55151  },

    { 9.11508, 8.33659, 6.76692, 6.46447, 7.15199, 7.47847, 6.93844, 7.35615, 7.31525, 7.73408, 5.40751, 6.72558, 7.03997, 7.47892, 6.58941, 9.66841, 12.3704, 12.5351, 11.839, 8.78713 },

    { 15.2334, 12.2836, 12.9684, 10.1321, 13.4777, 12.3912, 11.8814, 12.4256, 10.4787, 13.2936, 11.0627, 13.1273, 10.5516, 12.846, 11.8735, 17.7823, 23.8047, 26.6134, 22.7521, 13.7872},


    { 40.,   40.,   40.,   40.,   40.,   40.,   40.,   40.,   40.,   40.,   40.,   40.,   40.,   40.,  40.,   40.,   40.,   40.,   40., 40.}
    };


  // e-gamma mean response and sigma in HF 
  double _meanEM[maxEMe][maxEMeta] = 
    { 
       {22.15, 19.86, 23.73, 21.18, 21.61, 21.44, 17.84, 20.84, 18.57, 20.82, 19.76, 19.18, 20.52, 17.52, 16.99, 13.24, 16.33, 13.96, 12.7, 13.73},

      {74.4, 71.07, 74.38, 72.97, 73.14, 72.28, 68.42, 70.15, 69.66, 70.99, 69.19, 68.18, 70.05, 63.38, 46.62, 37.35, 26.47, 17.66, 24.08, 45.16},

  {221.437, 221.368, 222.783, 221.25, 219.083, 209.88, 206.721, 212.441, 211.412, 209.134, 206.064, 209.892, 206.92, 199.872, 140.668, 113.588, 51.5992, 27.5073, 38.904, 125.717},

      {759.313, 778.377, 759.422, 766.935, 734.067, 706.534, 697.785, 697.526, 708.746, 706.14, 685.874, 683.319, 677.348, 656.552, 502.097, 418.544, 97.3635, 62.7007, 100.774, 462.385},
    
      {2303.92, 2297.72, 2308.41, 2336.72, 2236.88, 2144.91, 2060.43, 2129.89, 2100.12, 2126.81, 2089.92, 2087.01, 2098.24, 1960.21, 1559.07, 1354.58, 486.69, 98.7363, 185.586, 1452.44}
    }; 

  double _sigmaEM[maxEMe][maxEMeta] =
    { 
      {10.01, 9.868, 9.699, 8.164, 8.973, 8.622, 8.275, 8.99, 9.267, 8.84, 9.112, 8.645, 8.947, 8.261, 7.808, 6.609, 7.955, 8.72, 5.978, 5.634},

      {23.01, 19.89, 22.86, 22.72, 19.62, 21.02, 18.72, 20.61, 20.38, 20.56, 21.89, 21.32, 20.96, 22.2, 20.95, 19.13, 19.37, 10.99, 18.76, 18.18},

      {52.19, 51.31, 52.33, 52.59, 50.07, 44.66, 48.86, 47.47, 49.44, 45.16, 50.99, 49.63, 51.04,   58, 54.86,   64, 57.27, 31.94, 43.17, 46.62},

      {167.3,  197, 166.4, 171.9, 148.9, 143.7, 173.4,  135, 159.9, 166.8,  151, 145.2, 158.6, 181.5, 155.3, 213.8, 126.1, 88.07, 132.4, 172.8},

      {426.8, 433.6, 464.1, 465.6, 429.3, 393.3, 426.7, 406.1, 378.8, 442.9, 460.2, 426.8, 458.1, 505.6, 476.1, 514.4,  264., 215.6, 293.1, 471.3}

    }; 


  // MUON probability histos for bin size = 0.25 GeV (0-10 GeV, 40 bins)  

  double _responseMU[maxMUet][maxMUeta][maxMUbin] = {
   { 
  // 10 GeV
     {1, 0.999009, 0.999009, 0.999009, 0.997027, 0.981169, 0.949455, 0.922696, 0.863231, 0.782953, 0.665015, 0.555996, 0.443013, 0.322101, 0.230922, 0.162537, 0.114965, 0.0812686, 0.0604559, 0.0475719, 0.0376611, 0.0307235, 0.0178394, 0.0138751, 0.0099108, 0.00792864, 0.00792864, 0.00693756, 0.00396432, 0.00297324, 0.00297324, 0.00198216, 0.00198216, 0.00198216, 0.00198216, 0.00198216, 0.00198216, 0.00099108, 0.00099108, 0}, 
     {1, 1, 1, 0.998037, 0.993131, 0.976447, 0.908734, 0.843965, 0.698724, 0.546614, 0.437684, 0.336605, 0.245339, 0.177625, 0.123651, 0.077527, 0.063788, 0.0451423, 0.0353288, 0.0284593, 0.0245339, 0.0215898, 0.0186457, 0.0147203, 0.013739, 0.00981354, 0.00490677, 0.00490677, 0.00392542, 0.00294406, 0.00294406, 0.00196271, 0.00196271, 0.00196271, 0.00196271, 0.000981354, 0.000981354, 0.000981354, 0.000981354, 0}, 
   {1, 1, 1, 1, 0.99854, 0.986861, 0.964964, 0.941606, 0.870073, 0.747445, 0.640876, 0.562044, 0.426277, 0.344526, 0.255474, 0.191241, 0.135766, 0.109489, 0.0729927, 0.0525547, 0.0423358, 0.0291971, 0.0233577, 0.0175182, 0.0131387, 0.010219, 0.00437956, 0.00437956, 0.00437956, 0.00291971, 0.00145985, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
   {1, 1, 1, 1, 1, 1, 0.987603, 0.982782, 0.9573, 0.909091, 0.85124, 0.800275, 0.727961, 0.626722, 0.536501, 0.447658, 0.341598, 0.274793, 0.208678, 0.153581, 0.125344, 0.0971074, 0.0764463, 0.0633609, 0.0495868, 0.0371901, 0.0316804, 0.0213499, 0.0172176, 0.0144628, 0.0110193, 0.00964187, 0.00826446, 0.00757576, 0.00688705, 0.00413223, 0.00344353, 0.00206612, 0.00206612, 0.00206612}, 
    {1, 0.995918, 0.995918, 0.995918, 0.953061, 0.846939, 0.75102, 0.634694, 0.512245, 0.355102, 0.263265, 0.218367, 0.136735, 0.0836735, 0.0612245, 0.0469388, 0.0326531, 0.0265306, 0.0142857, 0.0102041, 0.00408163, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 0, 0},
   {1, 0.999541, 0.999541, 0.999541, 0.996784, 0.977257, 0.977257, 0.909028, 0.909028, 0.769354, 0.698369, 0.698369, 0.455088, 0.244659, 0.244429, 0.129566, 0.129336, 0.0884448, 0.0443372, 0.0438778, 0.0238916, 0.0238916, 0.0130944, 0.00987824, 0.00735125, 0.00574317, 0.00436481, 0.00229727, 0.00229727, 0.00160809, 0.00160809, 0.00160809, 0.00114863, 0.00114863, 0.000459453, 0.000229727, 0.000229727, 0.000229727, 0.000229727, 0}
   },
   //30 GeV
   {
     {1, 1, 1, 1, 1, 0.997006, 0.981038, 0.963074, 0.928144, 0.852295, 0.761477, 0.662675, 0.538922, 0.399202, 0.299401, 0.234531, 0.190619, 0.154691, 0.125749, 0.0918164, 0.0718563, 0.0638723, 0.0568862, 0.0399202, 0.0319361, 0.0259481, 0.0199601, 0.0159681, 0.0149701, 0.011976, 0.00898204, 0.00798403, 0.00299401, 0.00299401, 0.00299401, 0.00299401, 0.00199601, 0.00199601, 0.000998004, 0.000998004}, 
     {1, 0.998024, 0.998024, 0.998024, 0.996047, 0.982213, 0.927866, 0.885375, 0.791502, 0.601779, 0.477273, 0.383399, 0.29249, 0.205534, 0.177866, 0.126482, 0.100791, 0.0790514, 0.0494071, 0.0375494, 0.0286561, 0.0217391, 0.0217391, 0.0158103, 0.0128458, 0.0118577, 0.0108696, 0.00988142, 0.00889328, 0.00889328, 0.00889328, 0.00790514, 0.00592885, 0.00592885, 0.00395257, 0.00197628, 0.000988142, 0.000988142, 0, 0}, 
     {1, 1, 1, 1, 1, 0.997041, 0.97929, 0.964497, 0.903846, 0.803254, 0.681953, 0.594675, 0.5, 0.360947, 0.298817, 0.214497, 0.150888, 0.130178, 0.0872781, 0.0695266, 0.0591716, 0.0384615, 0.0340237, 0.0251479, 0.0192308, 0.0177515, 0.0177515, 0.0162722, 0.0162722, 0.0133136, 0.010355, 0.00739645, 0.00443787, 0.00443787, 0.00443787, 0.00443787, 0.00295858, 0.00295858, 0, 0}, 
     {1, 1, 1, 1, 1, 0.999306, 0.997917, 0.997222, 0.986111, 0.953472, 0.901389, 0.865972, 0.775, 0.6625, 0.603472, 0.501389, 0.402083, 0.349306, 0.264583, 0.220833, 0.194444, 0.145139, 0.119444, 0.09375, 0.0763889, 0.0625, 0.0472222, 0.0368056, 0.0326389, 0.0291667, 0.0201389, 0.0145833, 0.0145833, 0.0111111, 0.00833333, 0.00694444, 0.00486111, 0.00416667, 0.00208333, 0.000694444}, 
     {1, 0.991803, 0.991803, 0.991803, 0.969262, 0.881148, 0.762295, 0.67623, 0.532787, 0.409836, 0.295082, 0.243852, 0.188525, 0.139344, 0.122951, 0.0778689, 0.0532787, 0.0471311, 0.0368852, 0.0286885, 0.0286885, 0.022541, 0.0184426, 0.0163934, 0.0163934, 0.0122951, 0.0122951, 0.00819672, 0.00819672, 0.00819672, 0.00819672, 0.00614754, 0.00204918, 0.00204918, 0.00204918, 0.00204918, 0, 0, 0, 0}, 
     {1, 0.999304, 0.999304, 0.999304, 0.998609, 0.990958, 0.990958, 0.952469, 0.952237, 0.819615, 0.777417, 0.777417, 0.563877, 0.332251, 0.332251, 0.190587, 0.190587, 0.157663, 0.0987712, 0.0987712, 0.061674, 0.061674, 0.0377927, 0.0352423, 0.0268954, 0.0257361, 0.0234176, 0.0132159, 0.0127521, 0.0106654, 0.0106654, 0.00881057, 0.00394157, 0.00394157, 0.00370971, 0.001623, 0.001623, 0.000927429, 0.000927429, 0.000695572}
   },
   // 100 GeV
   {
     {1, 1, 1, 1, 1, 0.998976, 0.9826, 0.971341, 0.947799, 0.895599, 0.804504, 0.73695, 0.650972, 0.520983, 0.417605, 0.350051, 0.286592, 0.239509, 0.192426, 0.146366, 0.125896, 0.106448, 0.0921187, 0.073695, 0.0593654, 0.0470829, 0.0388946, 0.0286592, 0.0225179, 0.0214944, 0.0184237, 0.0153531, 0.0143296, 0.011259, 0.00921187, 0.00716479, 0.00716479, 0.00511771, 0.00409417, 0.00307062}, 
    {1, 1, 1, 1, 0.999004, 0.989044, 0.949203, 0.922311, 0.850598, 0.724104, 0.600598, 0.510956, 0.432271, 0.334661, 0.293825, 0.217131, 0.184263, 0.164343, 0.123506, 0.10757, 0.0916335, 0.0717131, 0.062749, 0.0507968, 0.0418327, 0.0408367, 0.0328685, 0.0278884, 0.0268924, 0.0229084, 0.0199203, 0.0179283, 0.0149402, 0.0119522, 0.0109562, 0.00996016, 0.00896414, 0.00697211, 0.00498008, 0.00199203},
    {1, 1, 1, 1, 1, 0.994048, 0.985119, 0.974702, 0.934524, 0.827381, 0.708333, 0.639881, 0.5625, 0.450893, 0.392857, 0.316964, 0.258929, 0.235119, 0.162202, 0.130952, 0.120536, 0.0907738, 0.078869, 0.0669643, 0.0625, 0.0565476, 0.047619, 0.0357143, 0.0342262, 0.0282738, 0.0208333, 0.0208333, 0.016369, 0.0133929, 0.0119048, 0.0104167, 0.00446429, 0.00446429, 0.0014881, 0.0014881}, 
    {1, 0.999281, 0.999281, 0.999281, 0.999281, 0.999281, 0.997124, 0.996405, 0.991373, 0.966211, 0.925953, 0.893602, 0.839684, 0.742631, 0.695902, 0.597412, 0.507549, 0.470884, 0.38821, 0.327822, 0.295471, 0.230769, 0.199856, 0.166068, 0.136592, 0.119339, 0.0941769, 0.0754853, 0.069734, 0.0603882, 0.0510424, 0.0409777, 0.0359454, 0.0287563, 0.0201294, 0.0143781, 0.0107836, 0.00790798, 0.00647017, 0.00359454}, 
    {1, 0.997934, 0.997934, 0.997934, 0.987603, 0.92562, 0.834711, 0.77686, 0.654959, 0.518595, 0.409091, 0.353306, 0.299587, 0.216942, 0.206612, 0.161157, 0.130165, 0.123967, 0.0909091, 0.0867769, 0.0681818, 0.053719, 0.0433884, 0.035124, 0.0330579, 0.0330579, 0.0289256, 0.0268595, 0.0227273, 0.0227273, 0.0206612, 0.018595, 0.0123967, 0.0103306, 0.00619835, 0.00619835, 0.00413223, 0.00413223, 0.00206612, 0.00206612},
    {1, 1, 1, 1, 0.999765, 0.995535, 0.9953, 0.970153, 0.969918, 0.881316, 0.853584, 0.853584, 0.670035, 0.441833, 0.441833, 0.286251, 0.286016, 0.251234, 0.171798, 0.171798, 0.114454, 0.114454, 0.0777908, 0.0747356, 0.0571093, 0.0552291, 0.053349, 0.0293772, 0.0293772, 0.026557, 0.0249119, 0.0211516, 0.012691, 0.0115159, 0.0110458, 0.00658049, 0.00634548, 0.00305523, 0.00305523, 0.00188014}
   },
   // 300 GeV
   {
     {1, 1, 1, 1, 1, 0.997817, 0.99345, 0.983624, 0.966157, 0.933406, 0.873362, 0.815502, 0.74345, 0.64083, 0.558952, 0.479258, 0.419214, 0.379913, 0.325328, 0.270742, 0.239083, 0.19869, 0.167031, 0.141921, 0.113537, 0.0971616, 0.0840611, 0.0687773, 0.058952, 0.0436681, 0.0393013, 0.0327511, 0.0305677, 0.0262009, 0.0196507, 0.0163755, 0.0120087, 0.00982533, 0.00873362, 0.00327511}, 
    {1, 1, 1, 1, 1, 0.996865, 0.972832, 0.948798, 0.904911, 0.802508, 0.719958, 0.649948, 0.584117, 0.491118, 0.46604, 0.364681, 0.331243, 0.308255, 0.244514, 0.221526, 0.202717, 0.169279, 0.15256, 0.126437, 0.111808, 0.106583, 0.0909091, 0.0783699, 0.0710554, 0.0574713, 0.0501567, 0.045977, 0.0376176, 0.0344828, 0.030303, 0.0261233, 0.0188088, 0.0135841, 0.0104493, 0.00522466}, 
    {1, 1, 1, 1, 1, 0.998415, 0.993661, 0.988906, 0.977813, 0.935024, 0.858954, 0.812995, 0.762282, 0.662441, 0.622821, 0.505547, 0.445325, 0.426307, 0.329635, 0.29794, 0.275753, 0.242472, 0.22187, 0.191759, 0.171157, 0.158479, 0.141046, 0.125198, 0.120444, 0.110935, 0.0982567, 0.0792393, 0.0586371, 0.0570523, 0.0538827, 0.0459588, 0.0332805, 0.0269414, 0.0174326, 0.0110935}, 
    {1, 1, 1, 1, 1, 1, 0.998436, 0.997654, 0.992963, 0.982017, 0.960125, 0.94527, 0.906177, 0.845192, 0.820954, 0.744332, 0.671618, 0.624707, 0.538702, 0.475371, 0.441751, 0.36982, 0.333855, 0.291634, 0.250977, 0.22674, 0.199375, 0.1681, 0.150899, 0.137608, 0.110242, 0.0992963, 0.0820954, 0.0664582, 0.0578577, 0.0453479, 0.0359656, 0.0289289, 0.0187647, 0.00938233},
    {1, 1, 1, 1, 0.989177, 0.941558, 0.887446, 0.839827, 0.75974, 0.612554, 0.525974, 0.478355, 0.426407, 0.361472, 0.350649, 0.279221, 0.253247, 0.24026, 0.168831, 0.145022, 0.134199, 0.108225, 0.101732, 0.0779221, 0.0606061, 0.0562771, 0.0497835, 0.04329, 0.0411255, 0.034632, 0.034632, 0.0238095, 0.0194805, 0.017316, 0.017316, 0.0108225, 0.0108225, 0.0108225, 0.00649351, 0.00649351},
     {1, 0.99926, 0.99926, 0.99926, 0.99852, 0.995312, 0.995312, 0.984949, 0.984703, 0.925241, 0.915865, 0.915865, 0.798668, 0.630891, 0.630891, 0.484826, 0.484579, 0.455712, 0.356279, 0.356279, 0.268937, 0.268937, 0.196891, 0.191463, 0.154453, 0.149519, 0.146558, 0.0957316, 0.0949914, 0.0885764, 0.0880829, 0.0745127, 0.0478658, 0.0471256, 0.0446583, 0.0264002, 0.0261535, 0.0157908, 0.0152973, 0.00986923}
   }
  };

  // now assign
  for (int i1 = 0; i1 < maxMUet; i1++) { 
    eGridMU[i1] = _eGridMU[i1];
    for (int i2 = 0; i2 < maxMUeta; i2++) {
      for (int i3 = 0; i3 < maxMUbin; i3++) {
	
	responseMU[i1][i2][i3] = _responseMU[i1][i2][i3];

	if(debug) {
	  //cout.width(6);
	  LogDebug("FastCalorimetry") << " responseMU " << i1 << " " << i2 << " " << i3  << " = " 
	       << responseMU[i1][i2][i3] << endl;
	}
	
      }
    }
  }
  for (int i2 = 0; i2 < maxMUeta; i2++) {
    etaGridMU[i2] = _etaGridMU[i2];
  }


  // Normalize the response and sigmas to the corresponding energies
  for(int i = 0; i<maxHDeB;  i++) {
    eGridHDB[i] = _eGridHDB[i];
    for(int j = 0; j<maxHDetaB; j++) {
       meanHDB[i][j] =  _meanHDB[i][j] / eGridHDB[i];
      sigmaHDB[i][j] =  _sigmaHDB[i][j] / eGridHDB[i];
    }
  }

  for(int i = 0; i<maxHDetF;  i++) {
    etGridHDF[i] = _etGridHDF[i];
    for(int j = 0; j<maxHDetaF; j++) {
       meanHDF[i][j] =  _meanHDF[i][j] / etGridHDF[i];
      sigmaHDF[i][j] =  _sigmaHDF[i][j] / etGridHDF[i];
    }
  }



  for(int i = 0; i<maxEMe;  i++) {
    eGridEM[i] = _eGridEM[i];
    for(int j = 0; j<maxEMeta; j++) {
       meanEM[i][j] = _meanEM[i][j] / eGridEM[i];
      sigmaEM[i][j] = _sigmaEM[i][j] / eGridEM[i];
    }
  }


}

 
pair<double,double> 
HCALResponse::responseHCAL(double energy, double eta, int partype)
{

  int ieta = abs((int)(eta / etaStep)) ;
  int ie = -1;

  // e/gamma
  if(partype == 0) {
    ieta -=  maxHDetaB;  // HF starts at eta=3, but resp.vector from index = 0
    if(ieta >= maxEMeta ) ieta = maxEMeta;
    else if(ieta < 0) ieta = 0;
 
    for (int i = 0; i < maxEMe; i++) {
      if(energy < eGridEM[i])  {
	if(i == 0) ie = 0;       
        else  ie = i-1;
        break;
      }
    }
    if(ie == -1) ie = maxEMe - 2;  
    interEM(energy, ie, ieta);
  }  
     
  else { 
    // hadrons
    if(partype == 1) {  
      
      if(ieta > maxHDetaB)  {  // HF
	ieta -= maxHDetaB; 

	if(ieta >= maxHDetaF) ieta = maxHDetaF;
	
	double et = energy / cosh (eta);
	for (int i = 0; i < maxHDetF; i++) {
	  if(et < etGridHDF[i])  {
	    if(i == 0) ie = 0;     // less than minimal -
	    else  ie = i-1;        // back extrapolation with the 1st interval
	    break;
	  }
	}
	if(ie == -1) ie = maxHDetF - 2;     // more than maximum - 
	interHDF(et, ie, ieta);             // extrapolation with last interv.
	// from Et normalized to energy and apply energy scale correction
	mean  *= cosh(eta) * eResponseCorrection;
	if(partype == 1) mean  += eBias;
	sigma *= cosh(eta) * eResponseCorrection;      
      }

      else { // HB
	if(ieta <0 ) ieta = 0;
	for (int i = 0; i < maxHDeB; i++) {
	  if(energy < eGridHDB[i])  {
	    if(i == 0) ie = 0;     // less than minimal -
	    else  ie = i-1;        // back extrapolation with the 1st interval
	    break;
	  }	
	}
	if(ie == -1) ie = maxHDeB - 2;     // more than maximum - 
	interHDB(energy, ie, ieta);        // extrapolation with last interv.
	// from E normalized to energy and apply energy scale correction
	mean  *= eResponseCorrection;
	if(partype == 1) mean  += eBias;
	sigma *= eResponseCorrection;      
      }

    }

  }
  
  // muons
  if(partype == 2) { 

    ieta = maxMUeta;
    for(int i = 0; i < maxMUeta; i++) {
      if(fabs(eta) < etaGridMU[i]) {
	ieta = i;  
	break;
      }       
    }     
    
    if(ieta < 0) ieta = 0;
    if(ieta < maxMUeta) {
      
	for (int i = 0; i < maxMUet; i++) {
	  if(energy < eGridMU[i])  {
	    if(i == 0) ie = 0;     // less than minimal -
	    else  ie = i-1;        // back extrapolation with the first interval
	    break;
	  }
	}
	if(ie == -1) ie = maxMUet - 2;     // more than maximum - 
	interMU(energy, ie, ieta);             // extrapolation using the last interv
        if(mean > energy) mean = energy;  

    }
    else mean = 0.;                      // muons in HF
  }


  // debugging
  if(debug) {
    //  cout.width(6);
  LogDebug("FastCalorimetry") << endl
       << " HCALResponse::responseHCAL, partype = " <<  partype << endl
       << " E, eta, part = " << energy << " " << eta << " " << partype << endl
       << " mean & sigma = " << mean   << " " << sigma << endl;

  }

  return pair<double,double>(mean,sigma);

}

void HCALResponse::interMU(double e, int ie, int ieta)
{

  double x = random->flatShoot();

  int bin1 = maxMUbin;
  for(int i = 0; i < maxMUbin; i++) {
    if(x > responseMU[ie][ieta][i]) {
      bin1 = i-1;
      break;
    }
  }
  int bin2 = maxMUbin;
  for(int i = 0; i < maxMUbin; i++) {
    if(x > responseMU[ie+1][ieta][i]) {
      bin2 = i-1;
      break;
    }
  }
   
  double x1 = eGridMU[ie];
  double x2 = eGridMU[ie+1];
  double y1 = (bin1 + random->flatShoot()) * muStep;   
  double y2 = (bin2 + random->flatShoot()) * muStep;   

  if(debug) {
    //  cout.width(6);
  LogDebug("FastCalorimetry") << endl
       << " HCALResponse::interMU  " << endl
       << " x, x1-x2, y1-y2 = " 
       << e << ", " << x1 <<"-" << x2 << " " << y1 <<"-" << y2 << endl; 
  
  }


  mean  = y1 + (y2-y1) * (e - x1)/(x2 - x1);
  sigma = 0.;

  if(debug) {
    //cout.width(6);
  LogDebug("FastCalorimetry") << endl
       << " HCALResponse::interMU " << endl
       << " e, ie, ieta = " << e << " " << ie << " " << ieta << endl
       << " response  = " << mean << endl; 
  }

}

void HCALResponse::interHDB(double et, int ie, int ieta)
{
  double y1 = meanHDB[ie][ieta]; 
  double y2 = meanHDB[ie+1][ieta]; 
  double x1 = eGridHDB[ie];
  double x2 = eGridHDB[ie+1];

  if(debug) {
    //  cout.width(6);
  LogDebug("FastCalorimetry") << endl
       << " HCALResponse::interHDB mean " << endl
       << " x, x1-x2, y1-y2 = " 
       << et << ", " << x1 <<"-" << x2 << " " << y1 <<"-" << y2 << endl; 
  
  }
  
  mean =  et * (y1 + (y2 - y1) * (et - x1)/(x2 - x1));      
  
  y1 = sigmaHDB[ie][ieta]; 
  y2 = sigmaHDB[ie+1][ieta]; 
  
  if(debug) {
    //  cout.width(6);
  LogDebug("FastCalorimetry") << endl
       << " HCALResponse::interHDB sigma" << endl
       << " x, x1-x2, y1-y2 = " 
       << et << ", " << x1 <<"-" << x2 << " " << y1 <<"-" << y2 << endl; 
  
  }
 
  sigma = et * (y1 + (y2 - y1) * (et - x1)/(x2 - x1));      


  if(debug) {
    //cout.width(6);
  LogDebug("FastCalorimetry") << endl
       << " HCALResponse::interHDB " << endl
       << " et, ie, ieta = " << et << " " << ie << " " << ieta << endl
       << " mean, sigma  = " << mean << " " << sigma << endl; 
  }

}


void HCALResponse::interHDF(double et, int ie, int ieta)
{
  double y1 = meanHDF[ie][ieta]; 
  double y2 = meanHDF[ie+1][ieta]; 
  double x1 = etGridHDF[ie];
  double x2 = etGridHDF[ie+1];

  if(debug) {
    //  cout.width(6);
  LogDebug("FastCalorimetry") << endl
       << " HCALResponse::interHDF mean " << endl
       << " x, x1-x2, y1-y2 = " 
       << et << ", " << x1 <<"-" << x2 << " " << y1 <<"-" << y2 << endl; 
  
  }
  
  mean =  et * (y1 + (y2 - y1) * (et - x1)/(x2 - x1));      
  
  y1 = sigmaHDF[ie][ieta]; 
  y2 = sigmaHDF[ie+1][ieta]; 
  
  if(debug) {
    //  cout.width(6);
  LogDebug("FastCalorimetry") << endl
       << " HCALResponse::interHDF sigma" << endl
       << " x, x1-x2, y1-y2 = " 
       << et << ", " << x1 <<"-" << x2 << " " << y1 <<"-" << y2 << endl; 
  
  }
 
  sigma = et * (y1 + (y2 - y1) * (et - x1)/(x2 - x1));      


  if(debug) {
    //cout.width(6);
  LogDebug("FastCalorimetry") << endl
       << " HCALResponse::interHDF " << endl
       << " et, ie, ieta = " << et << " " << ie << " " << ieta << endl
       << " mean, sigma  = " << mean << " " << sigma << endl; 
  }

}

void HCALResponse::interEM(double e, int ie, int ieta)
{ 
  double y1 = meanEM[ie][ieta]; 
  double y2 = meanEM[ie+1][ieta]; 
  double x1 = eGridEM[ie];
  double x2 = eGridEM[ie+1];
  
  if(debug) {
    //  cout.width(6);
  LogDebug("FastCalorimetry") << endl
       << " HCALResponse::interEM mean " << endl
       << " x, x1-x2, y1-y2 = " 
       << e << ", " << x1 <<"-" << x2 << " " << y1 <<"-" << y2 << endl; 
  
  }

  mean =  e * (y1 + (y2 - y1) * (e - x1)/(x2 - x1));      
  
  y1 = sigmaEM[ie][ieta]; 
  y2 = sigmaEM[ie+1][ieta]; 
  
  if(debug) {
    //  cout.width(6);
  LogDebug("FastCalorimetry") << endl
       << " HCALResponse::interEM sigma" << endl
       << " x, x1-x2, y1-y2 = " 
       << e << ", " << x1 <<"-" << x2 << " " << y1 <<"-" << y2 << endl; 
  
  }

  sigma = e * (y1 + (y2 - y1) * (e - x1)/(x2 - x1));      
}



// Old parametrization for hadrons
double HCALResponse::getHCALEnergyResolution(double e, int hit){
  
   if(hit==hcforward) 
     return e *sqrt( RespPar[VFCAL][1][0]*RespPar[VFCAL][1][0] / e + 
		     RespPar[VFCAL][1][1]*RespPar[VFCAL][1][1] );
   else
     return  e * sqrt( RespPar[HCAL][hit][0]*RespPar[HCAL][hit][0]/(e)
                     + RespPar[HCAL][hit][1]*RespPar[HCAL][hit][1]);   

}

// Old parameterization of the calo response to hadrons
double HCALResponse::getHCALEnergyResponse(double e, int hit){

  double s = eResponseScale[hit];
  double n = eResponseExponent;
  double p = eResponsePlateau[hit];
  double c = eResponseCoefficient;

  double response = e * p / (1+c*exp(n * log(s/e)));

  if(response<0.) response = 0.;

  return response;
}

// old parameterization of the HF response to electrons
double HCALResponse::getHFEnergyResolution(double EGen)
{
    return EGen *sqrt( RespPar[VFCAL][0][0]*RespPar[VFCAL][0][0] / EGen + 
		       RespPar[VFCAL][0][1]*RespPar[VFCAL][0][1] );
}  


#ifdef IJKLMMNOP // This stuff was moved to Calorimetry.cfi
// default values for old prameterizations
const double HCALResponse::RespByDefault[3][2][3] = {
//Numbers taken from Calorimetry TDR's.
  //ECAL - dummy, the numbers are in  FASTEnergyReconstructor.cc
  //Stochastic Constant Noise 
 {{3*0.},   //barrel
  {3*0.}}, //endcap
  //HCAL
 {{1.22,       0.05,       0},    //barrel
  {1.30,       0.05,       0}},   //endcap (R. Harris - 17-oct-2004)
  //VFCAL
 {{1.82,       0.09,    0},  //hadrons
  {1.38,       0.05,    0}}  //electrons & photons
};
#endif
