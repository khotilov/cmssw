#! /bin/env cmsRun

process test = {
 
    # input file
    source = PoolSource {
        untracked vstring fileNames = { "file:./b_jets_reco.root" }      
  untracked int32 maxEvents = -1
    }

    module out = PoolOutputModule {
        untracked string fileName = 'btag.root'
    }


    # Message Logger
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
    replace MessageLogger.cout.threshold = "INFO"
       # Magnetic Field
    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
    include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"

    include "TrackingTools/TransientTrack/data/TransientTrackBuilder.cfi" 
     include "RecoVertex/PrimaryVertexProducer/data/OfflinePrimaryVerticesFromCTFTracks.cff"

    # Test tracks to jets association
    module jetTrackAssociations = JetTracksAssociator {
      string tracks = "CTFWMaterial"
      string jets   = "CaloJetIcone5"
      double coneSize = 0.5
    }

    module trackCountingJetTags = TrackCounting {
      string jetTracks = "jetTrackAssociations"
      string primaryVertex = "offlinePrimaryVerticesFromCTFTracks"        


      PSet AlgorithmPSet =  { 
         int32    NthTrack = 2
         int32    ImpactParamterType = 0 
         int32    MinimumNumberOfPixelHits = 2
         int32   MinimumNumberOfHits = 8
         double MaximumTransverseImpactParameter = 0.2
         double MinimumTransverseMomentum = 1.0
         double MaximumDecayLength = 5.0
         double MaximumChiSquared = 5.0
         double MaximumLongitudinalImpactParameter = 170.0
        }
    }

    # module execution

    path p = { offlinePrimaryVerticesFromCTFTracks, jetTrackAssociations, trackCountingJetTags }

     endpath outpath = { out }
}
