#! /bin/env cmsRun

process test = {
 
    # input file
    source = PoolSource {
        untracked vstring fileNames = { "/store/mc/2006/12/22/mc-physval-120-BBbar50to80-LowLumiPU/0016/001E138D-DB97-DB11-91F8-003048767D6B.root" }
	  untracked int32 maxEvents = 20 
    }

    module out = PoolOutputModule {
        untracked string fileName = 'btag.root'
    }


    # Message Logger
#    include "FWCore/MessageLogger/data/MessageLogger.cfi"
 #   replace MessageLogger.cout.threshold = "INFO"
  
  service = MessageLogger
  {
  untracked vstring destinations   = { "debugmessages.txt" }
  untracked vstring categories     = { "BTagTools" }
  untracked vstring debugModules   = { "trackCountingJetTags" }
  untracked PSet debugmessages.txt = { untracked string threshold = "DEBUG"
                                       untracked PSet INFO            = { untracked int32 limit = 0 }
                                       untracked PSet DEBUG           = { untracked int32 limit = 0 }
                                       untracked PSet BTagTools       = { untracked int32 limit = 10000000}
                                     }
  }


     # Magnetic Field
    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
    include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"

    include "TrackingTools/TransientTrack/data/TransientTrackBuilder.cfi" 
 #    include "RecoVertex/PrimaryVertexProducer/data/OfflinePrimaryVerticesFromCTFTracks.cff"


#    include "RecoBTag/TrackCounting/data/trackCounting.cff"
#    include "RecoBTau/JetTracksAssociator/data/jetTracksAssociator.cff"

   module trackCountingJetTags2 = TrackCounting {
      string jetTracks = "jetTracksAssociator"
      string primaryVertex = "offlinePrimaryVerticesFromCTFTracks"
      PSet AlgorithmPSet =  {
         int32    NthTrack = 2
         int32    ImpactParamterType = 0
         int32    MinimumNumberOfPixelHits = 2
         int32   MinimumNumberOfHits = 8
         double MaximumTransverseImpactParameter = 0.2
         double MinimumTransverseMomentum = 1.0
         double MaximumDecayLength = 5.0
         double MaximumChiSquared = 5.0
         double MaximumLongitudinalImpactParameter = 170.0
         double MaximumDistanceToJetAxis = 0.07
       }
    }
    # module execution

    path p = { trackCountingJetTags2 }

     endpath outpath = { out }
}
